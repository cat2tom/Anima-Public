<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ANIMA: animaGraph.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ANIMA
   &#160;<span id="projectnumber">2.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">animaGraph.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="animaGraph_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* graph.h */</span>
<a name="l00002"></a>00002 <span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment">###################################################################</span>
<a name="l00004"></a>00004 <span class="comment">#                                                                 #</span>
<a name="l00005"></a>00005 <span class="comment">#    MAXFLOW - software for computing mincut/maxflow in a graph   #</span>
<a name="l00006"></a>00006 <span class="comment">#                        Version 3.0                              #</span>
<a name="l00007"></a>00007 <span class="comment">#    http://www.cs.adastral.ucl.ac.uk/~vnk/software.html          #</span>
<a name="l00008"></a>00008 <span class="comment">#                                                                 #</span>
<a name="l00009"></a>00009 <span class="comment">#    Yuri Boykov (yuri@csd.uwo.ca)                                #</span>
<a name="l00010"></a>00010 <span class="comment">#    Vladimir Kolmogorov (vnk@adastral.ucl.ac.uk)                 #</span>
<a name="l00011"></a>00011 <span class="comment">#    2001-2006                                                    #</span>
<a name="l00012"></a>00012 <span class="comment">#                                                                 #</span>
<a name="l00013"></a>00013 <span class="comment">###################################################################</span>
<a name="l00014"></a>00014 <span class="comment"></span>
<a name="l00015"></a>00015 <span class="comment">1. Introduction.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">This software library implements the maxflow algorithm described in</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">        &quot;An Experimental Comparison of Min-Cut/Max-Flow Algorithms for Energy Minimization in Vision.&quot;</span>
<a name="l00020"></a>00020 <span class="comment">        Yuri Boykov and Vladimir Kolmogorov.</span>
<a name="l00021"></a>00021 <span class="comment">        In IEEE Transactions on Pattern Analysis and Machine Intelligence (PAMI),</span>
<a name="l00022"></a>00022 <span class="comment">        September 2004</span>
<a name="l00023"></a>00023 <span class="comment"></span>
<a name="l00024"></a>00024 <span class="comment">This algorithm was developed by Yuri Boykov and Vladimir Kolmogorov</span>
<a name="l00025"></a>00025 <span class="comment">at Siemens Corporate Research. To make it available for public use,</span>
<a name="l00026"></a>00026 <span class="comment">it was later reimplemented by Vladimir Kolmogorov based on open publications.</span>
<a name="l00027"></a>00027 <span class="comment"></span>
<a name="l00028"></a>00028 <span class="comment">If you use this software for research purposes, you should cite</span>
<a name="l00029"></a>00029 <span class="comment">the aforementioned paper in any resulting publication.</span>
<a name="l00030"></a>00030 <span class="comment"></span>
<a name="l00031"></a>00031 <span class="comment">----------------------------------------------------------------------</span>
<a name="l00032"></a>00032 <span class="comment"></span>
<a name="l00033"></a>00033 <span class="comment">REUSING TREES:</span>
<a name="l00034"></a>00034 <span class="comment"></span>
<a name="l00035"></a>00035 <span class="comment">Starting with version 3.0, there is a also an option of reusing search</span>
<a name="l00036"></a>00036 <span class="comment">trees from one maxflow computation to the next, as described in</span>
<a name="l00037"></a>00037 <span class="comment"></span>
<a name="l00038"></a>00038 <span class="comment">        &quot;Efficiently Solving Dynamic Markov Random Fields Using Graph Cuts.&quot;</span>
<a name="l00039"></a>00039 <span class="comment">        Pushmeet Kohli and Philip H.S. Torr</span>
<a name="l00040"></a>00040 <span class="comment">        International Conference on Computer Vision (ICCV), 2005</span>
<a name="l00041"></a>00041 <span class="comment"></span>
<a name="l00042"></a>00042 <span class="comment">If you use this option, you should cite</span>
<a name="l00043"></a>00043 <span class="comment">the aforementioned paper in any resulting publication.</span>
<a name="l00044"></a>00044 <span class="comment"></span>
<a name="l00045"></a>00045 <span class="comment">Tested under windows, Visual C++ 6.0 compiler and unix (SunOS 5.8</span>
<a name="l00046"></a>00046 <span class="comment">and RedHat Linux 7.0, GNU c++ compiler).</span>
<a name="l00047"></a>00047 <span class="comment"></span>
<a name="l00048"></a>00048 <span class="comment">##################################################################</span>
<a name="l00049"></a>00049 <span class="comment"></span>
<a name="l00050"></a>00050 <span class="comment">2. License &amp; disclaimer.</span>
<a name="l00051"></a>00051 <span class="comment"></span>
<a name="l00052"></a>00052 <span class="comment">    Copyright 2001 Vladimir Kolmogorov (vnk@adastral.ucl.ac.uk), Yuri Boykov (yuri@csd.uwo.ca).</span>
<a name="l00053"></a>00053 <span class="comment"></span>
<a name="l00054"></a>00054 <span class="comment">    This software can be used for research purposes only.</span>
<a name="l00055"></a>00055 <span class="comment"></span>
<a name="l00056"></a>00056 <span class="comment">    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00057"></a>00057 <span class="comment">    &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00058"></a>00058 <span class="comment">    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00059"></a>00059 <span class="comment">    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00060"></a>00060 <span class="comment">    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00061"></a>00061 <span class="comment">    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00062"></a>00062 <span class="comment">    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00063"></a>00063 <span class="comment">    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00064"></a>00064 <span class="comment">    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00065"></a>00065 <span class="comment">    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00066"></a>00066 <span class="comment">    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00067"></a>00067 <span class="comment"></span>
<a name="l00068"></a>00068 <span class="comment">##################################################################</span>
<a name="l00069"></a>00069 <span class="comment">*/</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="preprocessor">#pragma once</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &quot;<a class="code" href="animaBlock_8h.html">animaBlock.h</a>&quot;</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00078"></a>00078 <span class="comment">// NOTE: in UNIX you need to use -DNDEBUG preprocessor option to supress assert&#39;s!!!</span>
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="comment">// captype: type of edge capacities (excluding t-links)</span>
<a name="l00083"></a>00083 <span class="comment">// tcaptype: type of t-links (edges between nodes and terminals)</span>
<a name="l00084"></a>00084 <span class="comment">// flowtype: type of total flow</span>
<a name="l00085"></a>00085 <span class="comment">//</span>
<a name="l00086"></a>00086 <span class="comment">// Current instantiations are in instances.inc</span>
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="keyword">namespace </span>anima {
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="classanima_1_1Graph.html">00091</a> <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt; <span class="keyword">class </span><a class="code" href="classanima_1_1Graph.html">Graph</a>
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093 <span class="keyword">public</span>:
<a name="l00094"></a><a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10">00094</a>     <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l00095"></a>00095     {
<a name="l00096"></a><a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10aaf1f957b9b5210ea8762fecfca05c29b">00096</a>         <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10aaf1f957b9b5210ea8762fecfca05c29b">SOURCE</a>  = 0,
<a name="l00097"></a><a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10a928f0a34c8c8a734bed53018d3fa301e">00097</a>         <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10a928f0a34c8c8a734bed53018d3fa301e">SINK</a>    = 1
<a name="l00098"></a>00098               } <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10">termtype</a>; <span class="comment">// terminals</span>
<a name="l00099"></a><a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">00099</a>     <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>;
<a name="l00100"></a>00100 
<a name="l00102"></a>00102     <span class="comment">//                     BASIC INTERFACE FUNCTIONS                       //</span>
<a name="l00103"></a>00103     <span class="comment">//              (should be enough for most applications)               //</span>
<a name="l00105"></a>00105 <span class="comment"></span>
<a name="l00106"></a>00106     <span class="comment">// Constructor.</span>
<a name="l00107"></a>00107     <span class="comment">// The first argument gives an estimate of the maximum number of nodes that can be added</span>
<a name="l00108"></a>00108     <span class="comment">// to the graph, and the second argument is an estimate of the maximum number of edges.</span>
<a name="l00109"></a>00109     <span class="comment">// The last (optional) argument is the pointer to the function which will be called</span>
<a name="l00110"></a>00110     <span class="comment">// if an error occurs; an error message is passed to this function.</span>
<a name="l00111"></a>00111     <span class="comment">// If this argument is omitted, exit(1) will be called.</span>
<a name="l00112"></a>00112     <span class="comment">//</span>
<a name="l00113"></a>00113     <span class="comment">// IMPORTANT: It is possible to add more nodes to the graph than node_num_max</span>
<a name="l00114"></a>00114     <span class="comment">// (and node_num_max can be zero). However, if the count is exceeded, then</span>
<a name="l00115"></a>00115     <span class="comment">// the internal memory is reallocated (increased by 50%) which is expensive.</span>
<a name="l00116"></a>00116     <span class="comment">// Also, temporarily the amount of allocated memory would be more than twice than needed.</span>
<a name="l00117"></a>00117     <span class="comment">// Similarly for edges.</span>
<a name="l00118"></a>00118     <span class="comment">// If you wish to avoid this overhead, you can download version 2.2, where nodes and edges are stored in blocks.</span>
<a name="l00119"></a>00119     <a class="code" href="classanima_1_1Graph.html#add55107f6ddc88e9b80442c4bf5e0939">Graph</a>(<span class="keywordtype">int</span> node_num_max, <span class="keywordtype">int</span> edge_num_max, <span class="keywordtype">void</span> (*err_function)(<span class="keywordtype">char</span> *) = NULL);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121     <span class="comment">// Destructor</span>
<a name="l00122"></a>00122     <a class="code" href="classanima_1_1Graph.html#ad3002810e4c236d0198a2671f807675a">~Graph</a>();
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="comment">// Adds node(s) to the graph. By default, one node is added (num=1); then first call returns 0, second call returns 1, and so on.</span>
<a name="l00125"></a>00125     <span class="comment">// If num&gt;1, then several nodes are added, and node_id of the first one is returned.</span>
<a name="l00126"></a>00126     <span class="comment">// IMPORTANT: see note about the constructor</span>
<a name="l00127"></a>00127     <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> <a class="code" href="classanima_1_1Graph.html#affb603661d56915a9db15b4d07abd028">add_node</a>(<span class="keywordtype">int</span> num = 1);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <span class="comment">// Adds a bidirectional edge between &#39;i&#39; and &#39;j&#39; with the weights &#39;cap&#39; and &#39;rev_cap&#39;.</span>
<a name="l00130"></a>00130     <span class="comment">// IMPORTANT: see note about the constructor</span>
<a name="l00131"></a>00131     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a33e4517ae47127172c099d23c89cd121">add_edge</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i, <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> j, captype cap, captype rev_cap);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="comment">// Adds new edges &#39;SOURCE-&gt;i&#39; and &#39;i-&gt;SINK&#39; with corresponding weights.</span>
<a name="l00134"></a>00134     <span class="comment">// Can be called multiple times for each node.</span>
<a name="l00135"></a>00135     <span class="comment">// Weights can be negative.</span>
<a name="l00136"></a>00136     <span class="comment">// NOTE: the number of such edges is not counted in edge_num_max.</span>
<a name="l00137"></a>00137     <span class="comment">//       No internal memory is allocated by this call.</span>
<a name="l00138"></a>00138     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#af8536ef3680b008ed901589c8a9dcffe">add_tweights</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i, tcaptype cap_source, tcaptype cap_sink);
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <span class="comment">// Computes the maxflow. Can be called several times.</span>
<a name="l00142"></a>00142     <span class="comment">// FOR DESCRIPTION OF reuse_trees, SEE mark_node().</span>
<a name="l00143"></a>00143     <span class="comment">// FOR DESCRIPTION OF changed_list, SEE remove_from_changed_list().</span>
<a name="l00144"></a>00144     flowtype <a class="code" href="classanima_1_1Graph.html#a9da5daefeba42c4d9c1d3ae401c7cef9">maxflow</a>(<span class="keywordtype">bool</span> reuse_trees = <span class="keyword">false</span>, <a class="code" href="classanima_1_1Block.html">Block&lt;node_id&gt;</a>* <a class="code" href="classanima_1_1Graph.html#a149608d49d43ddc4f2edd335d7e004eb">changed_list</a> = NULL);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     <span class="comment">// After the maxflow is computed, this function returns to which</span>
<a name="l00147"></a>00147     <span class="comment">// segment the node &#39;i&#39; belongs (Graph&lt;captype,tcaptype,flowtype&gt;::SOURCE or Graph&lt;captype,tcaptype,flowtype&gt;::SINK).</span>
<a name="l00148"></a>00148     <span class="comment">//</span>
<a name="l00149"></a>00149     <span class="comment">// Occasionally there may be several minimum cuts. If a node can be assigned</span>
<a name="l00150"></a>00150     <span class="comment">// to both the source and the sink, then default_segm is returned.</span>
<a name="l00151"></a>00151     <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10">termtype</a> <a class="code" href="classanima_1_1Graph.html#ac457956b1b48505659429d5021f1285b">what_segment</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i, <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10">termtype</a> default_segm = <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10aaf1f957b9b5210ea8762fecfca05c29b">SOURCE</a>);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 
<a name="l00156"></a>00156     <span class="comment">//       ADVANCED INTERFACE FUNCTIONS       //</span>
<a name="l00157"></a>00157     <span class="comment">//      (provide access to the graph)       //</span>
<a name="l00159"></a>00159 <span class="comment"></span>
<a name="l00160"></a>00160     <span class="comment">//private:</span>
<a name="l00161"></a>00161 <span class="keyword">public</span>:
<a name="l00162"></a>00162     <span class="keyword">struct </span><a class="code" href="structanima_1_1Graph_1_1node.html">node</a>;
<a name="l00163"></a>00163     <span class="keyword">struct </span><a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="keyword">public</span>:
<a name="l00166"></a>00166 
<a name="l00168"></a>00168     <span class="comment">// 1. Reallocating graph. //</span>
<a name="l00170"></a>00170 <span class="comment"></span>
<a name="l00171"></a>00171     <span class="comment">// Removes all nodes and edges.</span>
<a name="l00172"></a>00172     <span class="comment">// After that functions add_node() and add_edge() must be called again.</span>
<a name="l00173"></a>00173     <span class="comment">//</span>
<a name="l00174"></a>00174     <span class="comment">// Advantage compared to deleting Graph and allocating it again:</span>
<a name="l00175"></a>00175     <span class="comment">// no calls to delete/new (which could be quite slow).</span>
<a name="l00176"></a>00176     <span class="comment">//</span>
<a name="l00177"></a>00177     <span class="comment">// If the graph structure stays the same, then an alternative</span>
<a name="l00178"></a>00178     <span class="comment">// is to go through all nodes/edges and set new residual capacities</span>
<a name="l00179"></a>00179     <span class="comment">// (see functions below).</span>
<a name="l00180"></a>00180     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a46289b93360f8846565046011ab4ea4b">reset</a>();
<a name="l00181"></a>00181 
<a name="l00183"></a>00183     <span class="comment">// 2. Functions for getting pointers to arcs and for reading graph structure. //</span>
<a name="l00184"></a>00184     <span class="comment">//    NOTE: adding new arcs may invalidate these pointers (if reallocation    //</span>
<a name="l00185"></a>00185     <span class="comment">//    happens). So it&#39;s best not to add arcs while reading graph structure.   //</span>
<a name="l00187"></a>00187 <span class="comment"></span>
<a name="l00188"></a>00188     <span class="comment">// The following two functions return arcs in the same order that they</span>
<a name="l00189"></a>00189     <span class="comment">// were added to the graph. NOTE: for each call add_edge(i,j,cap,cap_rev)</span>
<a name="l00190"></a>00190     <span class="comment">// the first arc returned will be i-&gt;j, and the second j-&gt;i.</span>
<a name="l00191"></a>00191     <span class="comment">// If there are no more arcs, then the function can still be called, but</span>
<a name="l00192"></a>00192     <span class="comment">// the returned arc_id is undetermined.</span>
<a name="l00193"></a><a class="code" href="classanima_1_1Graph.html#af647b8c077eec785eb122175a1bc60a6">00193</a>     <span class="keyword">typedef</span> <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* <a class="code" href="classanima_1_1Graph.html#af647b8c077eec785eb122175a1bc60a6">arc_id</a>;
<a name="l00194"></a>00194     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc_id</a> <a class="code" href="classanima_1_1Graph.html#a8521093186ab14956be3f9dbf66c7fa1">get_first_arc</a>();
<a name="l00195"></a>00195     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc_id</a> <a class="code" href="classanima_1_1Graph.html#abfb603d1b9bb62721821bcbe5801cfd1">get_next_arc</a>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc_id</a> a);
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="comment">// other functions for reading graph structure</span>
<a name="l00198"></a><a class="code" href="classanima_1_1Graph.html#a457ea6b343e2401bb67c94f0646d04cf">00198</a>     <span class="keywordtype">int</span> <a class="code" href="classanima_1_1Graph.html#a457ea6b343e2401bb67c94f0646d04cf">get_node_num</a>() { <span class="keywordflow">return</span> <a class="code" href="classanima_1_1Graph.html#a176155eb7ef713e7f58bb4b40aa6c28b">node_num</a>; }
<a name="l00199"></a><a class="code" href="classanima_1_1Graph.html#a28ff4d40bc628815e02dbded2dc38db6">00199</a>     <span class="keywordtype">int</span> <a class="code" href="classanima_1_1Graph.html#a28ff4d40bc628815e02dbded2dc38db6">get_arc_num</a>() { <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(<a class="code" href="classanima_1_1Graph.html#aed0336060be28200c7fe323f5225086c">arc_last</a> - <a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">arcs</a>); }
<a name="l00200"></a>00200     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#aea26698baebb35305632efc813133fbd">get_arc_ends</a>(<a class="code" href="classanima_1_1Graph.html#af647b8c077eec785eb122175a1bc60a6">arc_id</a> a, <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>&amp; i, <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>&amp; j); <span class="comment">// returns i,j to that a = i-&gt;j</span>
<a name="l00201"></a>00201 
<a name="l00203"></a>00203     <span class="comment">// 3. Functions for reading residual capacities. //</span>
<a name="l00205"></a>00205 <span class="comment"></span>
<a name="l00206"></a>00206     <span class="comment">// returns residual capacity of SOURCE-&gt;i minus residual capacity of i-&gt;SINK</span>
<a name="l00207"></a>00207     tcaptype <a class="code" href="classanima_1_1Graph.html#ab29d5d8544012dd5b5322055eb22cf3a">get_trcap</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i);
<a name="l00208"></a>00208     <span class="comment">// returns residual capacity of arc a</span>
<a name="l00209"></a>00209     captype <a class="code" href="classanima_1_1Graph.html#a97036c3d2a222304f7d87d29012ffa7d">get_rcap</a>(arc* a);
<a name="l00210"></a>00210 
<a name="l00212"></a>00212     <span class="comment">// 4. Functions for setting residual capacities.               //</span>
<a name="l00213"></a>00213     <span class="comment">//    NOTE: If these functions are used, the value of the flow //</span>
<a name="l00214"></a>00214     <span class="comment">//    returned by maxflow() will not be valid!                 //</span>
<a name="l00216"></a>00216 <span class="comment"></span>
<a name="l00217"></a>00217     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a42198d11ebc0bc357b60c432f09dc201">set_trcap</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i, tcaptype trcap);
<a name="l00218"></a>00218     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#adf846c81844fd1016eed8b9eb42115f2">set_rcap</a>(arc* a, captype rcap);
<a name="l00219"></a>00219 
<a name="l00221"></a>00221     <span class="comment">// 5. Functions related to reusing trees &amp; list of changed nodes. //</span>
<a name="l00223"></a>00223 <span class="comment"></span>
<a name="l00224"></a>00224     <span class="comment">// If flag reuse_trees is true while calling maxflow(), then search trees</span>
<a name="l00225"></a>00225     <span class="comment">// are reused from previous maxflow computation.</span>
<a name="l00226"></a>00226     <span class="comment">// In this case before calling maxflow() the user must</span>
<a name="l00227"></a>00227     <span class="comment">// specify which parts of the graph have changed by calling mark_node():</span>
<a name="l00228"></a>00228     <span class="comment">//   add_tweights(i),set_trcap(i)    =&gt; call mark_node(i)</span>
<a name="l00229"></a>00229     <span class="comment">//   add_edge(i,j),set_rcap(a)       =&gt; call mark_node(i); mark_node(j)</span>
<a name="l00230"></a>00230     <span class="comment">//</span>
<a name="l00231"></a>00231     <span class="comment">// This option makes sense only if a small part of the graph is changed.</span>
<a name="l00232"></a>00232     <span class="comment">// The initialization procedure goes only through marked nodes then.</span>
<a name="l00233"></a>00233     <span class="comment">//</span>
<a name="l00234"></a>00234     <span class="comment">// mark_node(i) can either be called before or after graph modification.</span>
<a name="l00235"></a>00235     <span class="comment">// Can be called more than once per node, but calls after the first one</span>
<a name="l00236"></a>00236     <span class="comment">// do not have any effect.</span>
<a name="l00237"></a>00237     <span class="comment">//</span>
<a name="l00238"></a>00238     <span class="comment">// NOTE:</span>
<a name="l00239"></a>00239     <span class="comment">//   - This option cannot be used in the first call to maxflow().</span>
<a name="l00240"></a>00240     <span class="comment">//   - It is not necessary to call mark_node() if the change is ``not essential&#39;&#39;,</span>
<a name="l00241"></a>00241     <span class="comment">//     i.e. sign(trcap) is preserved for a node and zero/nonzero status is preserved for an arc.</span>
<a name="l00242"></a>00242     <span class="comment">//   - To check that you marked all necessary nodes, you can call maxflow(false) after calling maxflow(true).</span>
<a name="l00243"></a>00243     <span class="comment">//     If everything is correct, the two calls must return the same value of flow. (Useful for debugging).</span>
<a name="l00244"></a>00244     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a4e33ba43fd49e26b4ef23402d3071463">mark_node</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     <span class="comment">// If changed_list is not NULL while calling maxflow(), then the algorithm</span>
<a name="l00247"></a>00247     <span class="comment">// keeps a list of nodes which could potentially have changed their segmentation label.</span>
<a name="l00248"></a>00248     <span class="comment">// Nodes which are not in the list are guaranteed to keep their old segmentation label (SOURCE or SINK).</span>
<a name="l00249"></a>00249     <span class="comment">// Example usage:</span>
<a name="l00250"></a>00250     <span class="comment">//</span>
<a name="l00251"></a>00251     <span class="comment">//      typedef Graph&lt;int,int,int&gt; G;</span>
<a name="l00252"></a>00252     <span class="comment">//      G* g = new Graph(nodeNum, edgeNum);</span>
<a name="l00253"></a>00253     <span class="comment">//      Block&lt;G::node_id&gt;* changed_list = new Block&lt;G::node_id&gt;(128);</span>
<a name="l00254"></a>00254     <span class="comment">//</span>
<a name="l00255"></a>00255     <span class="comment">//      ... // add nodes and edges</span>
<a name="l00256"></a>00256     <span class="comment">//</span>
<a name="l00257"></a>00257     <span class="comment">//      g-&gt;maxflow(); // first call should be without arguments</span>
<a name="l00258"></a>00258     <span class="comment">//      for (int iter=0; iter&lt;10; iter++)</span>
<a name="l00259"></a>00259     <span class="comment">//      {</span>
<a name="l00260"></a>00260     <span class="comment">//          ... // change graph, call mark_node() accordingly</span>
<a name="l00261"></a>00261     <span class="comment">//</span>
<a name="l00262"></a>00262     <span class="comment">//          g-&gt;maxflow(true, changed_list);</span>
<a name="l00263"></a>00263     <span class="comment">//          G::node_id* ptr;</span>
<a name="l00264"></a>00264     <span class="comment">//          for (ptr=changed_list-&gt;ScanFirst(); ptr; ptr=changed_list-&gt;ScanNext())</span>
<a name="l00265"></a>00265     <span class="comment">//          {</span>
<a name="l00266"></a>00266     <span class="comment">//              G::node_id i = *ptr; assert(i&gt;=0 &amp;&amp; i&lt;nodeNum);</span>
<a name="l00267"></a>00267     <span class="comment">//              g-&gt;remove_from_changed_list(i);</span>
<a name="l00268"></a>00268     <span class="comment">//              // do something with node i...</span>
<a name="l00269"></a>00269     <span class="comment">//              if (g-&gt;what_segment(i) == G::SOURCE) { ... }</span>
<a name="l00270"></a>00270     <span class="comment">//          }</span>
<a name="l00271"></a>00271     <span class="comment">//          changed_list-&gt;Reset();</span>
<a name="l00272"></a>00272     <span class="comment">//      }</span>
<a name="l00273"></a>00273     <span class="comment">//      delete changed_list;</span>
<a name="l00274"></a>00274     <span class="comment">//</span>
<a name="l00275"></a>00275     <span class="comment">// NOTE:</span>
<a name="l00276"></a>00276     <span class="comment">//  - If changed_list option is used, then reuse_trees must be used as well.</span>
<a name="l00277"></a>00277     <span class="comment">//  - In the example above, the user may omit calls g-&gt;remove_from_changed_list(i) and changed_list-&gt;Reset() in a given iteration.</span>
<a name="l00278"></a>00278     <span class="comment">//    Then during the next call to maxflow(true, &amp;changed_list) new nodes will be added to changed_list.</span>
<a name="l00279"></a>00279     <span class="comment">//  - If the next call to maxflow() does not use option reuse_trees, then calling remove_from_changed_list()</span>
<a name="l00280"></a>00280     <span class="comment">//    is not necessary. (&quot;changed_list-&gt;Reset()&quot; or &quot;delete changed_list&quot; should still be called, though).</span>
<a name="l00281"></a><a class="code" href="classanima_1_1Graph.html#a74e24d3b2cec1380219be197a9f5eadc">00281</a>     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a74e24d3b2cec1380219be197a9f5eadc">remove_from_changed_list</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i)
<a name="l00282"></a>00282     {
<a name="l00283"></a>00283         assert(i&gt;=0 &amp;&amp; i&lt;<a class="code" href="classanima_1_1Graph.html#a176155eb7ef713e7f58bb4b40aa6c28b">node_num</a> &amp;&amp; <a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">nodes</a>[i].is_in_changed_list);
<a name="l00284"></a>00284         <a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">nodes</a>[i].<a class="code" href="structanima_1_1Graph_1_1node.html#ab4a8413c017769355eab70c033d9bb12">is_in_changed_list</a> = 0;
<a name="l00285"></a>00285     }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     <span class="comment">//private:</span>
<a name="l00297"></a>00297 <span class="keyword">public</span>:
<a name="l00298"></a>00298     <span class="comment">// internal variables and functions</span>
<a name="l00299"></a>00299 
<a name="l00300"></a><a class="code" href="structanima_1_1Graph_1_1node.html">00300</a>     <span class="keyword">struct </span><a class="code" href="structanima_1_1Graph_1_1node.html">node</a>
<a name="l00301"></a>00301     {
<a name="l00302"></a><a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">00302</a>         <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>         *<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>;     <span class="comment">// first outcoming arc</span>
<a name="l00303"></a>00303 
<a name="l00304"></a><a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">00304</a>         <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>         *<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>;    <span class="comment">// node&#39;s parent</span>
<a name="l00305"></a><a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">00305</a>         <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>        *<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a>;      <span class="comment">// pointer to the next active node</span>
<a name="l00306"></a>00306         <span class="comment">//   (or to itself if it is the last node in the list)</span>
<a name="l00307"></a><a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">00307</a>         <span class="keywordtype">int</span>         <a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a>;         <span class="comment">// timestamp showing when DIST was computed</span>
<a name="l00308"></a><a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">00308</a>         <span class="keywordtype">int</span>         <a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">DIST</a>;       <span class="comment">// distance to the terminal</span>
<a name="l00309"></a><a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">00309</a>         <span class="keywordtype">int</span>         <a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> : 1;    <span class="comment">// flag showing whether the node is in the source or in the sink tree (if parent!=NULL)</span>
<a name="l00310"></a><a class="code" href="structanima_1_1Graph_1_1node.html#a543e469810ecb7eca63890f20f0075f5">00310</a>         <span class="keywordtype">int</span>         <a class="code" href="structanima_1_1Graph_1_1node.html#a543e469810ecb7eca63890f20f0075f5">is_marked</a> : 1;  <span class="comment">// set by mark_node()</span>
<a name="l00311"></a><a class="code" href="structanima_1_1Graph_1_1node.html#ab4a8413c017769355eab70c033d9bb12">00311</a>         <span class="keywordtype">int</span>         <a class="code" href="structanima_1_1Graph_1_1node.html#ab4a8413c017769355eab70c033d9bb12">is_in_changed_list</a> : 1; <span class="comment">// set by maxflow if</span>
<a name="l00312"></a>00312 
<a name="l00313"></a><a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">00313</a>         tcaptype    <a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a>;     <span class="comment">// if tr_cap &gt; 0 then tr_cap is residual capacity of the arc SOURCE-&gt;node</span>
<a name="l00314"></a>00314         <span class="comment">// otherwise         -tr_cap is residual capacity of the arc node-&gt;SINK</span>
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     };
<a name="l00317"></a>00317 
<a name="l00318"></a><a class="code" href="structanima_1_1Graph_1_1arc.html">00318</a>     <span class="keyword">struct </span><a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>
<a name="l00319"></a>00319     {
<a name="l00320"></a><a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">00320</a>         <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>        *<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>;      <span class="comment">// node the arc points to</span>
<a name="l00321"></a><a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">00321</a>         <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>         *<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>;      <span class="comment">// next arc with the same originating node</span>
<a name="l00322"></a><a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">00322</a>         <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>         *<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>;    <span class="comment">// reverse arc</span>
<a name="l00323"></a>00323 
<a name="l00324"></a><a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">00324</a>         captype     <a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>;      <span class="comment">// residual capacity</span>
<a name="l00325"></a>00325     };
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="structanima_1_1Graph_1_1nodeptr.html">00327</a>     <span class="keyword">struct </span><a class="code" href="structanima_1_1Graph_1_1nodeptr.html">nodeptr</a>
<a name="l00328"></a>00328     {
<a name="l00329"></a><a class="code" href="structanima_1_1Graph_1_1nodeptr.html#ae7b302e232c3278c42f8f121cab61b05">00329</a>         <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>        *<a class="code" href="structanima_1_1Graph_1_1nodeptr.html#ae7b302e232c3278c42f8f121cab61b05">ptr</a>;
<a name="l00330"></a><a class="code" href="structanima_1_1Graph_1_1nodeptr.html#ad28da686b91d6bcdc84f703bd4f3648e">00330</a>         <a class="code" href="structanima_1_1Graph_1_1nodeptr.html">nodeptr</a>     *<a class="code" href="structanima_1_1Graph_1_1nodeptr.html#ad28da686b91d6bcdc84f703bd4f3648e">next</a>;
<a name="l00331"></a>00331     };
<a name="l00332"></a><a class="code" href="classanima_1_1Graph.html#abbf03704d6a7c130058e8813cfea2c20">00332</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classanima_1_1Graph.html#abbf03704d6a7c130058e8813cfea2c20">NODEPTR_BLOCK_SIZE</a> = 128;
<a name="l00333"></a>00333 
<a name="l00334"></a><a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">00334</a>     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>                *<a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">nodes</a>, *<a class="code" href="classanima_1_1Graph.html#abe9c1c12578ba670a587158cbc8a617e">node_last</a>, *<a class="code" href="classanima_1_1Graph.html#a66ec4957f791379b31ea2325fe39c4ea">node_max</a>; <span class="comment">// node_last = nodes+node_num, node_max = nodes+node_num_max;</span>
<a name="l00335"></a><a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">00335</a>     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>                 *<a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">arcs</a>, *<a class="code" href="classanima_1_1Graph.html#aed0336060be28200c7fe323f5225086c">arc_last</a>, *<a class="code" href="classanima_1_1Graph.html#ab83ec079f7a0be2f471c41acfec84d91">arc_max</a>; <span class="comment">// arc_last = arcs+2*edge_num, arc_max = arcs+2*edge_num_max;</span>
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="classanima_1_1Graph.html#a176155eb7ef713e7f58bb4b40aa6c28b">00337</a>     <span class="keywordtype">int</span>                 <a class="code" href="classanima_1_1Graph.html#a176155eb7ef713e7f58bb4b40aa6c28b">node_num</a>;
<a name="l00338"></a>00338 
<a name="l00339"></a><a class="code" href="classanima_1_1Graph.html#a75ff2bb6e7da2235abcdac8fa3bdc843">00339</a>     <a class="code" href="classanima_1_1DBlock.html">DBlock&lt;nodeptr&gt;</a>     *<a class="code" href="classanima_1_1Graph.html#a75ff2bb6e7da2235abcdac8fa3bdc843">nodeptr_block</a>;
<a name="l00340"></a>00340 
<a name="l00341"></a><a class="code" href="classanima_1_1Graph.html#a4a7585959a7c0ef169f8611762c5fc67">00341</a>     void    (*<a class="code" href="classanima_1_1Graph.html#a4a7585959a7c0ef169f8611762c5fc67">error_function</a>)(<span class="keywordtype">char</span> *);  <span class="comment">// this function is called if a error occurs,</span>
<a name="l00342"></a>00342     <span class="comment">// with a corresponding error message</span>
<a name="l00343"></a>00343     <span class="comment">// (or exit(1) is called if it&#39;s NULL)</span>
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="classanima_1_1Graph.html#a7f016cfb0f8d41cfa88b0a673e243c7a">00345</a>     flowtype            <a class="code" href="classanima_1_1Graph.html#a7f016cfb0f8d41cfa88b0a673e243c7a">flow</a>;       <span class="comment">// total flow</span>
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     <span class="comment">// reusing trees &amp; list of changed pixels</span>
<a name="l00348"></a><a class="code" href="classanima_1_1Graph.html#adef1c572b093f918d6a6d9550ae75efb">00348</a>     <span class="keywordtype">int</span>                 <a class="code" href="classanima_1_1Graph.html#adef1c572b093f918d6a6d9550ae75efb">maxflow_iteration</a>; <span class="comment">// counter</span>
<a name="l00349"></a><a class="code" href="classanima_1_1Graph.html#a149608d49d43ddc4f2edd335d7e004eb">00349</a>     <a class="code" href="classanima_1_1Block.html">Block&lt;node_id&gt;</a>      *<a class="code" href="classanima_1_1Graph.html#a149608d49d43ddc4f2edd335d7e004eb">changed_list</a>;
<a name="l00350"></a>00350 
<a name="l00352"></a>00352 
<a name="l00353"></a><a class="code" href="classanima_1_1Graph.html#a007fffa5dfc5c73578f259ed8f95db88">00353</a>     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>                *<a class="code" href="classanima_1_1Graph.html#a0f1ae0ff7a89b6b6d6b1cbcc5c53f88a">queue_first</a>[2], *<a class="code" href="classanima_1_1Graph.html#a007fffa5dfc5c73578f259ed8f95db88">queue_last</a>[2];    <span class="comment">// list of active nodes</span>
<a name="l00354"></a><a class="code" href="classanima_1_1Graph.html#a5841541ed18e7671b152212394a5a6ae">00354</a>     <a class="code" href="structanima_1_1Graph_1_1nodeptr.html">nodeptr</a>             *<a class="code" href="classanima_1_1Graph.html#aaff9a6025d49f9aff2a0f209fc03799b">orphan_first</a>, *<a class="code" href="classanima_1_1Graph.html#a5841541ed18e7671b152212394a5a6ae">orphan_last</a>;        <span class="comment">// list of pointers to orphans</span>
<a name="l00355"></a><a class="code" href="classanima_1_1Graph.html#aaa63afd7255bf3a83bf055e5e4a51127">00355</a>     <span class="keywordtype">int</span>                 <a class="code" href="classanima_1_1Graph.html#aaa63afd7255bf3a83bf055e5e4a51127">TIME</a>;                               <span class="comment">// monotonically increasing global counter</span>
<a name="l00356"></a>00356 
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a835631ff3e7748d130fa03eb378386a1">reallocate_nodes</a>(<span class="keywordtype">int</span> num); <span class="comment">// num is the number of new nodes</span>
<a name="l00360"></a>00360     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a468191ab1b47228f3fcd22bcdd3160ef">reallocate_arcs</a>();
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     <span class="comment">// functions for processing active list</span>
<a name="l00363"></a>00363     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a9d471e03db1c86d67305081f1ca49ff4">set_active</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i);
<a name="l00364"></a>00364     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *<a class="code" href="classanima_1_1Graph.html#aa1ca625c2cdae0a84bd89361cd12103c">next_active</a>();
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <span class="comment">// functions for processing orphans list</span>
<a name="l00367"></a>00367     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a92ab3905da1cd731e8c016708bcb9c4d">set_orphan_front</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* i); <span class="comment">// add to the beginning of the list</span>
<a name="l00368"></a>00368     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#ab9c34a5761ed987f1f4cbebaa50fc71c">set_orphan_rear</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* i);  <span class="comment">// add to the end of the list</span>
<a name="l00369"></a>00369 
<a name="l00370"></a>00370     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a1c28f099136473d1c07423e02c9f41aa">add_to_changed_list</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* i);
<a name="l00371"></a>00371 
<a name="l00372"></a>00372     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a6f3f6b2f62e4382a8e97a670af650673">maxflow_init</a>();             <span class="comment">// called if reuse_trees == false</span>
<a name="l00373"></a>00373     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a147e7a94f0e80efd7d48b6b45c0d8af9">maxflow_reuse_trees_init</a>(); <span class="comment">// called if reuse_trees == true</span>
<a name="l00374"></a>00374     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a075fa947e228c4f25f9ce689271f9395">augment</a>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *middle_arc);
<a name="l00375"></a>00375     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#aac9d70b6ee9606f93abf821120ab4c6d">process_source_orphan</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i);
<a name="l00376"></a>00376     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#aab21e9899a5e2984067cf9f4cce57d2a">process_sink_orphan</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i);
<a name="l00377"></a>00377 
<a name="l00378"></a>00378     <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a16d4d26f6655e2095c9b6ce22cc1c04f">test_consistency</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* current_node=NULL); <span class="comment">// debug function</span>
<a name="l00379"></a>00379 };
<a name="l00380"></a>00380 
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 
<a name="l00392"></a>00392 <span class="comment">// Implementation - inline functions //</span>
<a name="l00394"></a>00394 <span class="comment"></span>
<a name="l00395"></a>00395 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00396"></a><a class="code" href="classanima_1_1Graph.html#add55107f6ddc88e9b80442c4bf5e0939">00396</a>         <span class="keyword">inline</span> <a class="code" href="classanima_1_1Graph.html#add55107f6ddc88e9b80442c4bf5e0939">Graph&lt;captype, tcaptype, flowtype&gt;::Graph</a>(<span class="keywordtype">int</span> node_num_max, <span class="keywordtype">int</span> edge_num_max, <span class="keywordtype">void</span> (*err_function)(<span class="keywordtype">char</span> *))
<a name="l00397"></a>00397             : node_num(0),
<a name="l00398"></a>00398             nodeptr_block(NULL),
<a name="l00399"></a>00399             error_function(err_function)
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401     <span class="keywordflow">if</span> (node_num_max &lt; 16) node_num_max = 16;
<a name="l00402"></a>00402     <span class="keywordflow">if</span> (edge_num_max &lt; 16) edge_num_max = 16;
<a name="l00403"></a>00403     <a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">arcs</a> = (<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>*) malloc(2*edge_num_max*<span class="keyword">sizeof</span>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>));
<a name="l00404"></a>00404     <a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">nodes</a> = (<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>*) malloc(node_num_max*<span class="keyword">sizeof</span>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>));
<a name="l00405"></a>00405     <span class="keywordflow">if</span> (!<a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">nodes</a> || !<a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">arcs</a>) {
<a name="l00406"></a>00406         free(<a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">arcs</a>);
<a name="l00407"></a>00407         <span class="keywordflow">throw</span> std::bad_alloc();
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409     <a class="code" href="classanima_1_1Graph.html#abe9c1c12578ba670a587158cbc8a617e">node_last</a> = <a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">nodes</a>;
<a name="l00410"></a>00410     <a class="code" href="classanima_1_1Graph.html#a66ec4957f791379b31ea2325fe39c4ea">node_max</a> = <a class="code" href="classanima_1_1Graph.html#adb8d0c9e5120f602e5ad6b7c5c47ab65">nodes</a> + node_num_max;
<a name="l00411"></a>00411     <a class="code" href="classanima_1_1Graph.html#aed0336060be28200c7fe323f5225086c">arc_last</a> = <a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">arcs</a>;
<a name="l00412"></a>00412     <a class="code" href="classanima_1_1Graph.html#ab83ec079f7a0be2f471c41acfec84d91">arc_max</a> = <a class="code" href="classanima_1_1Graph.html#a0fa6803432544b2eb5938c0a83694e2b">arcs</a> + 2*edge_num_max;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     <a class="code" href="classanima_1_1Graph.html#adef1c572b093f918d6a6d9550ae75efb">maxflow_iteration</a> = 0;
<a name="l00415"></a>00415     <a class="code" href="classanima_1_1Graph.html#a7f016cfb0f8d41cfa88b0a673e243c7a">flow</a> = 0;
<a name="l00416"></a>00416 }
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00419"></a><a class="code" href="classanima_1_1Graph.html#ad3002810e4c236d0198a2671f807675a">00419</a>         <span class="keyword">inline</span> <a class="code" href="classanima_1_1Graph.html#ad3002810e4c236d0198a2671f807675a">Graph&lt;captype,tcaptype,flowtype&gt;::~Graph</a>()
<a name="l00420"></a>00420 {
<a name="l00421"></a>00421     <span class="keywordflow">if</span> (nodeptr_block)
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423         <span class="keyword">delete</span> nodeptr_block;
<a name="l00424"></a>00424         nodeptr_block = NULL;
<a name="l00425"></a>00425     }
<a name="l00426"></a>00426     free(nodes);
<a name="l00427"></a>00427     free(arcs);
<a name="l00428"></a>00428 }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00431"></a><a class="code" href="classanima_1_1Graph.html#a46289b93360f8846565046011ab4ea4b">00431</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a46289b93360f8846565046011ab4ea4b">Graph&lt;captype,tcaptype,flowtype&gt;::reset</a>()
<a name="l00432"></a>00432 {
<a name="l00433"></a>00433     node_last = nodes;
<a name="l00434"></a>00434     arc_last = arcs;
<a name="l00435"></a>00435     node_num = 0;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     <span class="keywordflow">if</span> (nodeptr_block)
<a name="l00438"></a>00438     {
<a name="l00439"></a>00439         <span class="keyword">delete</span> nodeptr_block;
<a name="l00440"></a>00440         nodeptr_block = NULL;
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     maxflow_iteration = 0;
<a name="l00444"></a>00444     flow = 0;
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00448"></a><a class="code" href="classanima_1_1Graph.html#a835631ff3e7748d130fa03eb378386a1">00448</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a835631ff3e7748d130fa03eb378386a1">Graph&lt;captype,tcaptype,flowtype&gt;::reallocate_nodes</a>(<span class="keywordtype">int</span> num)
<a name="l00449"></a>00449 {
<a name="l00450"></a>00450     <span class="keywordtype">int</span> node_num_max = (int)(node_max - nodes);
<a name="l00451"></a>00451     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* nodes_old = nodes;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     node_num_max += node_num_max / 2;
<a name="l00454"></a>00454     <span class="keywordflow">if</span> (node_num_max &lt; node_num + num) node_num_max = node_num + num;
<a name="l00455"></a>00455     nodes = (<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>*) realloc(nodes_old, node_num_max*<span class="keyword">sizeof</span>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>));
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (!nodes) { <span class="comment">/*if (error_function) (*error_function)(&quot;Not enough memory!&quot;);*/</span> exit(1); }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     node_last = nodes + node_num;
<a name="l00459"></a>00459     node_max = nodes + node_num_max;
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <span class="keywordflow">if</span> (nodes != nodes_old)
<a name="l00462"></a>00462     {
<a name="l00463"></a>00463         <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* a;
<a name="l00464"></a>00464         <span class="keywordflow">for</span> (a=arcs; a&lt;arc_last; a++)
<a name="l00465"></a>00465         {
<a name="l00466"></a>00466             a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a> = (<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>*) ((<span class="keywordtype">char</span>*)a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a> + (((<span class="keywordtype">char</span>*) nodes) - ((<span class="keywordtype">char</span>*) nodes_old)));
<a name="l00467"></a>00467         }
<a name="l00468"></a>00468     }
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00472"></a><a class="code" href="classanima_1_1Graph.html#a468191ab1b47228f3fcd22bcdd3160ef">00472</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a468191ab1b47228f3fcd22bcdd3160ef">Graph&lt;captype,tcaptype,flowtype&gt;::reallocate_arcs</a>()
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474 
<a name="l00475"></a>00475     <span class="keywordtype">int</span> arc_num_max = (int)(arc_max - arcs);
<a name="l00476"></a>00476     <span class="keywordtype">int</span> arc_num = (int)(arc_last - arcs);
<a name="l00477"></a>00477     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* arcs_old = arcs;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     arc_num_max += arc_num_max / 2; <span class="keywordflow">if</span> (arc_num_max &amp; 1) arc_num_max ++;
<a name="l00480"></a>00480     arcs = (<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>*) realloc(arcs_old, arc_num_max*<span class="keyword">sizeof</span>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>));
<a name="l00481"></a>00481     <span class="keywordflow">if</span> (!arcs) { <span class="comment">/*if (error_function) (*error_function)(&quot;Not enough memory!&quot;); */</span> exit(1); }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     arc_last = arcs + arc_num;
<a name="l00484"></a>00484     arc_max = arcs + arc_num_max;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486     <span class="keywordflow">if</span> (arcs != arcs_old)
<a name="l00487"></a>00487     {
<a name="l00488"></a>00488         <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* i;
<a name="l00489"></a>00489         <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* a;
<a name="l00490"></a>00490         <span class="keywordflow">for</span> (i=nodes; i&lt;node_last; i++)
<a name="l00491"></a>00491         {
<a name="l00492"></a>00492             <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>) i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a> = (<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>*) ((<span class="keywordtype">char</span>*)i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a> + (((<span class="keywordtype">char</span>*) arcs) - ((<span class="keywordtype">char</span>*) arcs_old)));
<a name="l00493"></a>00493         }
<a name="l00494"></a>00494         <span class="keywordflow">for</span> (a=arcs; a&lt;arc_last; a++)
<a name="l00495"></a>00495         {
<a name="l00496"></a>00496             <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>) a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a> = (<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>*) ((<span class="keywordtype">char</span>*)a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a> + (((<span class="keywordtype">char</span>*) arcs) - ((<span class="keywordtype">char</span>*) arcs_old)));
<a name="l00497"></a>00497             a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a> = (<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>*) ((<span class="keywordtype">char</span>*)a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a> + (((<span class="keywordtype">char</span>*) arcs) - ((<span class="keywordtype">char</span>*) arcs_old)));
<a name="l00498"></a>00498         }
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500 }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00503"></a><a class="code" href="classanima_1_1Graph.html#affb603661d56915a9db15b4d07abd028">00503</a>         <span class="keyword">inline</span> <span class="keyword">typename</span> <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">Graph&lt;captype,tcaptype,flowtype&gt;::node_id</a> <a class="code" href="classanima_1_1Graph.html#affb603661d56915a9db15b4d07abd028">Graph&lt;captype,tcaptype,flowtype&gt;::add_node</a>(<span class="keywordtype">int</span> num)
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505     assert(num &gt; 0);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     <span class="keywordflow">if</span> (node_last + num &gt; node_max) reallocate_nodes(num);
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="keywordflow">if</span> (num == 1)
<a name="l00510"></a>00510     {
<a name="l00511"></a>00511         node_last -&gt; first = NULL;
<a name="l00512"></a>00512         node_last -&gt; tr_cap = 0;
<a name="l00513"></a>00513         node_last -&gt; is_marked = 0;
<a name="l00514"></a>00514         node_last -&gt; is_in_changed_list = 0;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         node_last ++;
<a name="l00517"></a>00517         <span class="keywordflow">return</span> node_num ++;
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519     <span class="keywordflow">else</span>
<a name="l00520"></a>00520     {
<a name="l00521"></a>00521         memset(node_last, 0, num*<span class="keyword">sizeof</span>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>));
<a name="l00522"></a>00522 
<a name="l00523"></a>00523         <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i = node_num;
<a name="l00524"></a>00524         node_num += num;
<a name="l00525"></a>00525         node_last += num;
<a name="l00526"></a>00526         <span class="keywordflow">return</span> i;
<a name="l00527"></a>00527     }
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00531"></a><a class="code" href="classanima_1_1Graph.html#af8536ef3680b008ed901589c8a9dcffe">00531</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#af8536ef3680b008ed901589c8a9dcffe">Graph&lt;captype,tcaptype,flowtype&gt;::add_tweights</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i, tcaptype cap_source, tcaptype cap_sink)
<a name="l00532"></a>00532 {
<a name="l00533"></a>00533     assert(i &gt;= 0 &amp;&amp; i &lt; node_num);
<a name="l00534"></a>00534 
<a name="l00535"></a>00535     tcaptype delta = nodes[i].tr_cap;
<a name="l00536"></a>00536     <span class="keywordflow">if</span> (delta &gt; 0) cap_source += delta;
<a name="l00537"></a>00537     <span class="keywordflow">else</span>           cap_sink   -= delta;
<a name="l00538"></a>00538     flow += (cap_source &lt; cap_sink) ? cap_source : cap_sink;
<a name="l00539"></a>00539     nodes[i].tr_cap = cap_source - cap_sink;
<a name="l00540"></a>00540 }
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00543"></a><a class="code" href="classanima_1_1Graph.html#a33e4517ae47127172c099d23c89cd121">00543</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a33e4517ae47127172c099d23c89cd121">Graph&lt;captype,tcaptype,flowtype&gt;::add_edge</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> _i, <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> _j, captype cap, captype rev_cap)
<a name="l00544"></a>00544 {
<a name="l00545"></a>00545     assert(_i &gt;= 0 &amp;&amp; _i &lt; node_num);
<a name="l00546"></a>00546     assert(_j &gt;= 0 &amp;&amp; _j &lt; node_num);
<a name="l00547"></a>00547     assert(_i != _j);
<a name="l00548"></a>00548     assert(cap &gt;= 0);
<a name="l00549"></a>00549     assert(rev_cap &gt;= 0);
<a name="l00550"></a>00550 
<a name="l00551"></a>00551     <span class="keywordflow">if</span> (arc_last == arc_max) reallocate_arcs();
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *a = arc_last ++;
<a name="l00554"></a>00554     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *a_rev = arc_last ++;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* i = nodes + _i;
<a name="l00557"></a>00557     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* j = nodes + _j;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559     a -&gt; sister = a_rev;
<a name="l00560"></a>00560     a_rev -&gt; sister = a;
<a name="l00561"></a>00561     a -&gt; next = i -&gt; first;
<a name="l00562"></a>00562     i -&gt; first = a;
<a name="l00563"></a>00563     a_rev -&gt; next = j -&gt; first;
<a name="l00564"></a>00564     j -&gt; first = a_rev;
<a name="l00565"></a>00565     a -&gt; head = j;
<a name="l00566"></a>00566     a_rev -&gt; head = i;
<a name="l00567"></a>00567     a -&gt; r_cap = cap;
<a name="l00568"></a>00568     a_rev -&gt; r_cap = rev_cap;
<a name="l00569"></a>00569 }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00572"></a><a class="code" href="classanima_1_1Graph.html#a8521093186ab14956be3f9dbf66c7fa1">00572</a>         <span class="keyword">inline</span> <span class="keyword">typename</span> <a class="code" href="structanima_1_1Graph_1_1arc.html">Graph&lt;captype,tcaptype,flowtype&gt;::arc</a>* <a class="code" href="classanima_1_1Graph.html#a8521093186ab14956be3f9dbf66c7fa1">Graph&lt;captype,tcaptype,flowtype&gt;::get_first_arc</a>()
<a name="l00573"></a>00573 {
<a name="l00574"></a>00574     <span class="keywordflow">return</span> arcs;
<a name="l00575"></a>00575 }
<a name="l00576"></a>00576 
<a name="l00577"></a>00577 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00578"></a><a class="code" href="classanima_1_1Graph.html#abfb603d1b9bb62721821bcbe5801cfd1">00578</a>         <span class="keyword">inline</span> <span class="keyword">typename</span> <a class="code" href="structanima_1_1Graph_1_1arc.html">Graph&lt;captype,tcaptype,flowtype&gt;::arc</a>* <a class="code" href="classanima_1_1Graph.html#abfb603d1b9bb62721821bcbe5801cfd1">Graph&lt;captype,tcaptype,flowtype&gt;::get_next_arc</a>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* a)
<a name="l00579"></a>00579 {
<a name="l00580"></a>00580     <span class="keywordflow">return</span> a + 1;
<a name="l00581"></a>00581 }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00584"></a><a class="code" href="classanima_1_1Graph.html#aea26698baebb35305632efc813133fbd">00584</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#aea26698baebb35305632efc813133fbd">Graph&lt;captype,tcaptype,flowtype&gt;::get_arc_ends</a>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* a, <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>&amp; i, <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>&amp; j)
<a name="l00585"></a>00585 {
<a name="l00586"></a>00586     assert(a &gt;= arcs &amp;&amp; a &lt; arc_last);
<a name="l00587"></a>00587     i = (<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>) (a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a> - nodes);
<a name="l00588"></a>00588     j = (<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>) (a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a> - nodes);
<a name="l00589"></a>00589 }
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00592"></a><a class="code" href="classanima_1_1Graph.html#ab29d5d8544012dd5b5322055eb22cf3a">00592</a>         <span class="keyword">inline</span> tcaptype <a class="code" href="classanima_1_1Graph.html#ab29d5d8544012dd5b5322055eb22cf3a">Graph&lt;captype,tcaptype,flowtype&gt;::get_trcap</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i)
<a name="l00593"></a>00593 {
<a name="l00594"></a>00594     assert(i&gt;=0 &amp;&amp; i&lt;node_num);
<a name="l00595"></a>00595     <span class="keywordflow">return</span> nodes[i].tr_cap;
<a name="l00596"></a>00596 }
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00599"></a><a class="code" href="classanima_1_1Graph.html#a97036c3d2a222304f7d87d29012ffa7d">00599</a>         <span class="keyword">inline</span> captype <a class="code" href="classanima_1_1Graph.html#a97036c3d2a222304f7d87d29012ffa7d">Graph&lt;captype,tcaptype,flowtype&gt;::get_rcap</a>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* a)
<a name="l00600"></a>00600 {
<a name="l00601"></a>00601     assert(a &gt;= arcs &amp;&amp; a &lt; arc_last);
<a name="l00602"></a>00602     <span class="keywordflow">return</span> a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>;
<a name="l00603"></a>00603 }
<a name="l00604"></a>00604 
<a name="l00605"></a>00605 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00606"></a><a class="code" href="classanima_1_1Graph.html#a42198d11ebc0bc357b60c432f09dc201">00606</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a42198d11ebc0bc357b60c432f09dc201">Graph&lt;captype,tcaptype,flowtype&gt;::set_trcap</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i, tcaptype trcap)
<a name="l00607"></a>00607 {
<a name="l00608"></a>00608     assert(i&gt;=0 &amp;&amp; i&lt;node_num);
<a name="l00609"></a>00609     nodes[i].tr_cap = trcap;
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00613"></a><a class="code" href="classanima_1_1Graph.html#adf846c81844fd1016eed8b9eb42115f2">00613</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#adf846c81844fd1016eed8b9eb42115f2">Graph&lt;captype,tcaptype,flowtype&gt;::set_rcap</a>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* a, captype rcap)
<a name="l00614"></a>00614 {
<a name="l00615"></a>00615     assert(a &gt;= arcs &amp;&amp; a &lt; arc_last);
<a name="l00616"></a>00616     a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a> = rcap;
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00621"></a><a class="code" href="classanima_1_1Graph.html#ac457956b1b48505659429d5021f1285b">00621</a>         <span class="keyword">inline</span> <span class="keyword">typename</span> <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10">Graph&lt;captype,tcaptype,flowtype&gt;::termtype</a> <a class="code" href="classanima_1_1Graph.html#ac457956b1b48505659429d5021f1285b">Graph&lt;captype,tcaptype,flowtype&gt;::what_segment</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> i, <a class="code" href="classanima_1_1Graph.html#a5b6b70e2aec78300f4974f6617584a10">termtype</a> default_segm)
<a name="l00622"></a>00622 {
<a name="l00623"></a>00623     <span class="keywordflow">if</span> (nodes[i].parent)
<a name="l00624"></a>00624     {
<a name="l00625"></a>00625         <span class="keywordflow">return</span> (nodes[i].is_sink) ? SINK : SOURCE;
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627     <span class="keywordflow">else</span>
<a name="l00628"></a>00628     {
<a name="l00629"></a>00629         <span class="keywordflow">return</span> default_segm;
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631 }
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00634"></a><a class="code" href="classanima_1_1Graph.html#a4e33ba43fd49e26b4ef23402d3071463">00634</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a4e33ba43fd49e26b4ef23402d3071463">Graph&lt;captype,tcaptype,flowtype&gt;::mark_node</a>(<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a> _i)
<a name="l00635"></a>00635 {
<a name="l00636"></a>00636     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* i = nodes + _i;
<a name="l00637"></a>00637     <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a>)
<a name="l00638"></a>00638     {
<a name="l00639"></a>00639         <span class="comment">/* it&#39;s not in the list yet */</span>
<a name="l00640"></a>00640         <span class="keywordflow">if</span> (queue_last[1]) queue_last[1] -&gt; next = i;
<a name="l00641"></a>00641         <span class="keywordflow">else</span>               queue_first[1]        = i;
<a name="l00642"></a>00642         queue_last[1] = i;
<a name="l00643"></a>00643         i -&gt; next = i;
<a name="l00644"></a>00644     }
<a name="l00645"></a>00645     i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a543e469810ecb7eca63890f20f0075f5">is_marked</a> = 1;
<a name="l00646"></a>00646 }
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 <span class="comment">/*</span>
<a name="l00649"></a>00649 <span class="comment">        special constants for node-&gt;parent</span>
<a name="l00650"></a>00650 <span class="comment">*/</span>
<a name="l00651"></a><a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">00651</a> <span class="preprocessor">#define TERMINAL ( (arc *) 1 )      </span><span class="comment">/* to terminal */</span>
<a name="l00652"></a><a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">00652</a> <span class="preprocessor">#define ORPHAN   ( (arc *) 2 )      </span><span class="comment">/* orphan */</span>
<a name="l00653"></a>00653 
<a name="l00654"></a>00654 
<a name="l00655"></a><a class="code" href="animaGraph_8h.html#aa9bc927cb28ad2010a73a6506fb39519">00655</a> <span class="preprocessor">#define INFINITE_D ((int)(((unsigned)-1)/2))        </span><span class="comment">/* infinite distance to the terminal */</span>
<a name="l00656"></a>00656 
<a name="l00657"></a>00657 <span class="comment">/***********************************************************************/</span>
<a name="l00658"></a>00658 
<a name="l00659"></a>00659 <span class="comment">/*</span>
<a name="l00660"></a>00660 <span class="comment">        Functions for processing active list.</span>
<a name="l00661"></a>00661 <span class="comment">        i-&gt;next points to the next node in the list</span>
<a name="l00662"></a>00662 <span class="comment">        (or to i, if i is the last node in the list).</span>
<a name="l00663"></a>00663 <span class="comment">        If i-&gt;next is NULL iff i is not in the list.</span>
<a name="l00664"></a>00664 <span class="comment"></span>
<a name="l00665"></a>00665 <span class="comment">        There are two queues. Active nodes are added</span>
<a name="l00666"></a>00666 <span class="comment">        to the end of the second queue and read from</span>
<a name="l00667"></a>00667 <span class="comment">        the front of the first queue. If the first queue</span>
<a name="l00668"></a>00668 <span class="comment">        is empty, it is replaced by the second queue</span>
<a name="l00669"></a>00669 <span class="comment">        (and the second queue becomes empty).</span>
<a name="l00670"></a>00670 <span class="comment">*/</span>
<a name="l00671"></a>00671 
<a name="l00672"></a>00672 
<a name="l00673"></a>00673 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00674"></a><a class="code" href="classanima_1_1Graph.html#a9d471e03db1c86d67305081f1ca49ff4">00674</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a9d471e03db1c86d67305081f1ca49ff4">Graph&lt;captype,tcaptype,flowtype&gt;::set_active</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i)
<a name="l00675"></a>00675 {
<a name="l00676"></a>00676     <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a>)
<a name="l00677"></a>00677     {
<a name="l00678"></a>00678         <span class="comment">/* it&#39;s not in the list yet */</span>
<a name="l00679"></a>00679         <span class="keywordflow">if</span> (queue_last[1]) queue_last[1] -&gt; next = i;
<a name="l00680"></a>00680         <span class="keywordflow">else</span>               queue_first[1]        = i;
<a name="l00681"></a>00681         queue_last[1] = i;
<a name="l00682"></a>00682         i -&gt; next = i;
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684 }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686 <span class="comment">/*</span>
<a name="l00687"></a>00687 <span class="comment">        Returns the next active node.</span>
<a name="l00688"></a>00688 <span class="comment">        If it is connected to the sink, it stays in the list,</span>
<a name="l00689"></a>00689 <span class="comment">        otherwise it is removed from the list</span>
<a name="l00690"></a>00690 <span class="comment">*/</span>
<a name="l00691"></a>00691 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00692"></a><a class="code" href="classanima_1_1Graph.html#aa1ca625c2cdae0a84bd89361cd12103c">00692</a>         <span class="keyword">inline</span> <span class="keyword">typename</span> <a class="code" href="structanima_1_1Graph_1_1node.html">Graph&lt;captype,tcaptype,flowtype&gt;::node</a>* <a class="code" href="classanima_1_1Graph.html#aa1ca625c2cdae0a84bd89361cd12103c">Graph&lt;captype,tcaptype,flowtype&gt;::next_active</a>()
<a name="l00693"></a>00693 {
<a name="l00694"></a>00694     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i;
<a name="l00695"></a>00695 
<a name="l00696"></a>00696     <span class="keywordflow">while</span> ( 1 )
<a name="l00697"></a>00697     {
<a name="l00698"></a>00698         <span class="keywordflow">if</span> (!(i=queue_first[0]))
<a name="l00699"></a>00699         {
<a name="l00700"></a>00700             queue_first[0] = i = queue_first[1];
<a name="l00701"></a>00701             queue_last[0]  = queue_last[1];
<a name="l00702"></a>00702             queue_first[1] = NULL;
<a name="l00703"></a>00703             queue_last[1]  = NULL;
<a name="l00704"></a>00704             <span class="keywordflow">if</span> (!i) <span class="keywordflow">return</span> NULL;
<a name="l00705"></a>00705         }
<a name="l00706"></a>00706 
<a name="l00707"></a>00707         <span class="comment">/* remove it from the active list */</span>
<a name="l00708"></a>00708         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a> == i) queue_first[0] = queue_last[0] = NULL;
<a name="l00709"></a>00709         <span class="keywordflow">else</span>              queue_first[0] = i -&gt; next;
<a name="l00710"></a>00710         i -&gt; next = NULL;
<a name="l00711"></a>00711 
<a name="l00712"></a>00712         <span class="comment">/* a node in the list is active iff it has a parent */</span>
<a name="l00713"></a>00713         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>) <span class="keywordflow">return</span> i;
<a name="l00714"></a>00714     }
<a name="l00715"></a>00715 }
<a name="l00716"></a>00716 
<a name="l00717"></a>00717 <span class="comment">/***********************************************************************/</span>
<a name="l00718"></a>00718 
<a name="l00719"></a>00719 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00720"></a><a class="code" href="classanima_1_1Graph.html#a92ab3905da1cd731e8c016708bcb9c4d">00720</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a92ab3905da1cd731e8c016708bcb9c4d">Graph&lt;captype,tcaptype,flowtype&gt;::set_orphan_front</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i)
<a name="l00721"></a>00721 {
<a name="l00722"></a>00722     <a class="code" href="structanima_1_1Graph_1_1nodeptr.html">nodeptr</a> *np;
<a name="l00723"></a>00723     i -&gt; parent = <a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a>;
<a name="l00724"></a>00724     np = nodeptr_block -&gt; New();
<a name="l00725"></a>00725     np -&gt; ptr = i;
<a name="l00726"></a>00726     np -&gt; next = orphan_first;
<a name="l00727"></a>00727     orphan_first = np;
<a name="l00728"></a>00728 }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00731"></a><a class="code" href="classanima_1_1Graph.html#ab9c34a5761ed987f1f4cbebaa50fc71c">00731</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#ab9c34a5761ed987f1f4cbebaa50fc71c">Graph&lt;captype,tcaptype,flowtype&gt;::set_orphan_rear</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i)
<a name="l00732"></a>00732 {
<a name="l00733"></a>00733     <a class="code" href="structanima_1_1Graph_1_1nodeptr.html">nodeptr</a> *np;
<a name="l00734"></a>00734     i -&gt; parent = <a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a>;
<a name="l00735"></a>00735     np = nodeptr_block -&gt; New();
<a name="l00736"></a>00736     np -&gt; ptr = i;
<a name="l00737"></a>00737     <span class="keywordflow">if</span> (orphan_last) orphan_last -&gt; next = np;
<a name="l00738"></a>00738     <span class="keywordflow">else</span>             orphan_first        = np;
<a name="l00739"></a>00739     orphan_last = np;
<a name="l00740"></a>00740     np -&gt; next = NULL;
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 <span class="comment">/***********************************************************************/</span>
<a name="l00744"></a>00744 
<a name="l00745"></a>00745 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00746"></a><a class="code" href="classanima_1_1Graph.html#a1c28f099136473d1c07423e02c9f41aa">00746</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a1c28f099136473d1c07423e02c9f41aa">Graph&lt;captype,tcaptype,flowtype&gt;::add_to_changed_list</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i)
<a name="l00747"></a>00747 {
<a name="l00748"></a>00748     <span class="keywordflow">if</span> (changed_list &amp;&amp; !i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab4a8413c017769355eab70c033d9bb12">is_in_changed_list</a>)
<a name="l00749"></a>00749     {
<a name="l00750"></a>00750         <a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>* ptr = changed_list-&gt;New();
<a name="l00751"></a>00751         *ptr = (<a class="code" href="classanima_1_1Graph.html#a7571bb9e4188a19b5e1f01e51c9afe66">node_id</a>)(i - nodes);
<a name="l00752"></a>00752         i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab4a8413c017769355eab70c033d9bb12">is_in_changed_list</a> = <span class="keyword">true</span>;
<a name="l00753"></a>00753     }
<a name="l00754"></a>00754 }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756 <span class="comment">/***********************************************************************/</span>
<a name="l00757"></a>00757 
<a name="l00758"></a>00758 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00759"></a><a class="code" href="classanima_1_1Graph.html#a6f3f6b2f62e4382a8e97a670af650673">00759</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a6f3f6b2f62e4382a8e97a670af650673">Graph&lt;captype,tcaptype,flowtype&gt;::maxflow_init</a>()
<a name="l00760"></a>00760 {
<a name="l00761"></a>00761     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i;
<a name="l00762"></a>00762 
<a name="l00763"></a>00763     queue_first[0] = queue_last[0] = NULL;
<a name="l00764"></a>00764     queue_first[1] = queue_last[1] = NULL;
<a name="l00765"></a>00765     orphan_first = NULL;
<a name="l00766"></a>00766 
<a name="l00767"></a>00767     TIME = 0;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769     <span class="keywordflow">for</span> (i=nodes; i&lt;node_last; i++)
<a name="l00770"></a>00770     {
<a name="l00771"></a>00771         i -&gt; next = NULL;
<a name="l00772"></a>00772         i -&gt; is_marked = 0;
<a name="l00773"></a>00773         i -&gt; is_in_changed_list = 0;
<a name="l00774"></a>00774         i -&gt; TS = TIME;
<a name="l00775"></a>00775         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> &gt; 0)
<a name="l00776"></a>00776         {
<a name="l00777"></a>00777             <span class="comment">/* i is connected to the source */</span>
<a name="l00778"></a>00778             i -&gt; is_sink = 0;
<a name="l00779"></a>00779             i -&gt; parent = <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>;
<a name="l00780"></a>00780             set_active(i);
<a name="l00781"></a>00781             i -&gt; DIST = 1;
<a name="l00782"></a>00782         }
<a name="l00783"></a>00783         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> &lt; 0)
<a name="l00784"></a>00784         {
<a name="l00785"></a>00785             <span class="comment">/* i is connected to the sink */</span>
<a name="l00786"></a>00786             i -&gt; is_sink = 1;
<a name="l00787"></a>00787             i -&gt; parent = <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>;
<a name="l00788"></a>00788             set_active(i);
<a name="l00789"></a>00789             i -&gt; DIST = 1;
<a name="l00790"></a>00790         }
<a name="l00791"></a>00791         <span class="keywordflow">else</span>
<a name="l00792"></a>00792         {
<a name="l00793"></a>00793             i -&gt; parent = NULL;
<a name="l00794"></a>00794         }
<a name="l00795"></a>00795     }
<a name="l00796"></a>00796 }
<a name="l00797"></a>00797 
<a name="l00798"></a>00798 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00799"></a><a class="code" href="classanima_1_1Graph.html#a147e7a94f0e80efd7d48b6b45c0d8af9">00799</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a147e7a94f0e80efd7d48b6b45c0d8af9">Graph&lt;captype,tcaptype,flowtype&gt;::maxflow_reuse_trees_init</a>()
<a name="l00800"></a>00800 {
<a name="l00801"></a>00801     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* i;
<a name="l00802"></a>00802     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* j;
<a name="l00803"></a>00803     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* queue = queue_first[1];
<a name="l00804"></a>00804     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a>* a;
<a name="l00805"></a>00805     <a class="code" href="structanima_1_1Graph_1_1nodeptr.html">nodeptr</a>* np;
<a name="l00806"></a>00806 
<a name="l00807"></a>00807     queue_first[0] = queue_last[0] = NULL;
<a name="l00808"></a>00808     queue_first[1] = queue_last[1] = NULL;
<a name="l00809"></a>00809     orphan_first = orphan_last = NULL;
<a name="l00810"></a>00810 
<a name="l00811"></a>00811     TIME ++;
<a name="l00812"></a>00812 
<a name="l00813"></a>00813     <span class="keywordflow">while</span> ((i=queue))
<a name="l00814"></a>00814     {
<a name="l00815"></a>00815         queue = i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a>;
<a name="l00816"></a>00816         <span class="keywordflow">if</span> (queue == i) queue = NULL;
<a name="l00817"></a>00817         i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a> = NULL;
<a name="l00818"></a>00818         i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a543e469810ecb7eca63890f20f0075f5">is_marked</a> = 0;
<a name="l00819"></a>00819         set_active(i);
<a name="l00820"></a>00820 
<a name="l00821"></a>00821         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> == 0)
<a name="l00822"></a>00822         {
<a name="l00823"></a>00823             <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>) set_orphan_rear(i);
<a name="l00824"></a>00824             <span class="keywordflow">continue</span>;
<a name="l00825"></a>00825         }
<a name="l00826"></a>00826 
<a name="l00827"></a>00827         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> &gt; 0)
<a name="l00828"></a>00828         {
<a name="l00829"></a>00829             <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> || i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>)
<a name="l00830"></a>00830             {
<a name="l00831"></a>00831                 i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> = 0;
<a name="l00832"></a>00832                 <span class="keywordflow">for</span> (a=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a; a=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l00833"></a>00833                 {
<a name="l00834"></a>00834                     j = a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>;
<a name="l00835"></a>00835                     <span class="keywordflow">if</span> (!j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a543e469810ecb7eca63890f20f0075f5">is_marked</a>)
<a name="l00836"></a>00836                     {
<a name="l00837"></a>00837                         <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> == a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>) set_orphan_rear(j);
<a name="l00838"></a>00838                         <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> &amp;&amp; j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> &amp;&amp; a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a> &gt; 0) set_active(j);
<a name="l00839"></a>00839                     }
<a name="l00840"></a>00840                 }
<a name="l00841"></a>00841                 add_to_changed_list(i);
<a name="l00842"></a>00842             }
<a name="l00843"></a>00843         }
<a name="l00844"></a>00844         <span class="keywordflow">else</span>
<a name="l00845"></a>00845         {
<a name="l00846"></a>00846             <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> || !i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>)
<a name="l00847"></a>00847             {
<a name="l00848"></a>00848                 i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> = 1;
<a name="l00849"></a>00849                 <span class="keywordflow">for</span> (a=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a; a=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l00850"></a>00850                 {
<a name="l00851"></a>00851                     j = a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>;
<a name="l00852"></a>00852                     <span class="keywordflow">if</span> (!j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a543e469810ecb7eca63890f20f0075f5">is_marked</a>)
<a name="l00853"></a>00853                     {
<a name="l00854"></a>00854                         <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> == a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>) set_orphan_rear(j);
<a name="l00855"></a>00855                         <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> &amp;&amp; !j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> &amp;&amp; a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a> &gt; 0) set_active(j);
<a name="l00856"></a>00856                     }
<a name="l00857"></a>00857                 }
<a name="l00858"></a>00858                 add_to_changed_list(i);
<a name="l00859"></a>00859             }
<a name="l00860"></a>00860         }
<a name="l00861"></a>00861         i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> = <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>;
<a name="l00862"></a>00862         i -&gt; TS = TIME;
<a name="l00863"></a>00863         i -&gt; DIST = 1;
<a name="l00864"></a>00864     }
<a name="l00865"></a>00865 
<a name="l00866"></a>00866     <span class="comment">//test_consistency();</span>
<a name="l00867"></a>00867 
<a name="l00868"></a>00868     <span class="comment">/* adoption */</span>
<a name="l00869"></a>00869     <span class="keywordflow">while</span> ((np=orphan_first))
<a name="l00870"></a>00870     {
<a name="l00871"></a>00871         orphan_first = np -&gt; next;
<a name="l00872"></a>00872         i = np -&gt; ptr;
<a name="l00873"></a>00873         nodeptr_block -&gt; Delete(np);
<a name="l00874"></a>00874         <span class="keywordflow">if</span> (!orphan_first) orphan_last = NULL;
<a name="l00875"></a>00875         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>) process_sink_orphan(i);
<a name="l00876"></a>00876         <span class="keywordflow">else</span>            process_source_orphan(i);
<a name="l00877"></a>00877     }
<a name="l00878"></a>00878     <span class="comment">/* adoption end */</span>
<a name="l00879"></a>00879 
<a name="l00880"></a>00880     <span class="comment">//test_consistency();</span>
<a name="l00881"></a>00881 }
<a name="l00882"></a>00882 
<a name="l00883"></a>00883 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00884"></a><a class="code" href="classanima_1_1Graph.html#a075fa947e228c4f25f9ce689271f9395">00884</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a075fa947e228c4f25f9ce689271f9395">Graph&lt;captype,tcaptype,flowtype&gt;::augment</a>(<a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *middle_arc)
<a name="l00885"></a>00885 {
<a name="l00886"></a>00886     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i;
<a name="l00887"></a>00887     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *a;
<a name="l00888"></a>00888     tcaptype bottleneck;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890 
<a name="l00891"></a>00891     <span class="comment">/* 1. Finding bottleneck capacity */</span>
<a name="l00892"></a>00892     <span class="comment">/* 1a - the source tree */</span>
<a name="l00893"></a>00893     bottleneck = middle_arc -&gt; r_cap;
<a name="l00894"></a>00894     <span class="keywordflow">for</span> (i=middle_arc-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>; ; i=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>)
<a name="l00895"></a>00895     {
<a name="l00896"></a>00896         a = i -&gt; parent;
<a name="l00897"></a>00897         <span class="keywordflow">if</span> (a == <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>) <span class="keywordflow">break</span>;
<a name="l00898"></a>00898         <span class="keywordflow">if</span> (bottleneck &gt; a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>) bottleneck = a -&gt; sister -&gt; r_cap;
<a name="l00899"></a>00899     }
<a name="l00900"></a>00900     <span class="keywordflow">if</span> (bottleneck &gt; i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a>) bottleneck = i -&gt; tr_cap;
<a name="l00901"></a>00901     <span class="comment">/* 1b - the sink tree */</span>
<a name="l00902"></a>00902     <span class="keywordflow">for</span> (i=middle_arc-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>; ; i=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>)
<a name="l00903"></a>00903     {
<a name="l00904"></a>00904         a = i -&gt; parent;
<a name="l00905"></a>00905         <span class="keywordflow">if</span> (a == <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>) <span class="keywordflow">break</span>;
<a name="l00906"></a>00906         <span class="keywordflow">if</span> (bottleneck &gt; a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>) bottleneck = a -&gt; r_cap;
<a name="l00907"></a>00907     }
<a name="l00908"></a>00908     <span class="keywordflow">if</span> (bottleneck &gt; - i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a>) bottleneck = - i -&gt; tr_cap;
<a name="l00909"></a>00909 
<a name="l00910"></a>00910 
<a name="l00911"></a>00911     <span class="comment">/* 2. Augmenting */</span>
<a name="l00912"></a>00912     <span class="comment">/* 2a - the source tree */</span>
<a name="l00913"></a>00913     middle_arc -&gt; sister -&gt; r_cap += bottleneck;
<a name="l00914"></a>00914     middle_arc -&gt; r_cap -= bottleneck;
<a name="l00915"></a>00915     <span class="keywordflow">for</span> (i=middle_arc-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>; ; i=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>)
<a name="l00916"></a>00916     {
<a name="l00917"></a>00917         a = i -&gt; parent;
<a name="l00918"></a>00918         <span class="keywordflow">if</span> (a == <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>) <span class="keywordflow">break</span>;
<a name="l00919"></a>00919         a -&gt; r_cap += bottleneck;
<a name="l00920"></a>00920         a -&gt; sister -&gt; r_cap -= bottleneck;
<a name="l00921"></a>00921         <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>)
<a name="l00922"></a>00922         {
<a name="l00923"></a>00923             set_orphan_front(i); <span class="comment">// add i to the beginning of the adoption list</span>
<a name="l00924"></a>00924         }
<a name="l00925"></a>00925     }
<a name="l00926"></a>00926     i -&gt; tr_cap -= bottleneck;
<a name="l00927"></a>00927     <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a>)
<a name="l00928"></a>00928     {
<a name="l00929"></a>00929         set_orphan_front(i); <span class="comment">// add i to the beginning of the adoption list</span>
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931     <span class="comment">/* 2b - the sink tree */</span>
<a name="l00932"></a>00932     <span class="keywordflow">for</span> (i=middle_arc-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>; ; i=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>)
<a name="l00933"></a>00933     {
<a name="l00934"></a>00934         a = i -&gt; parent;
<a name="l00935"></a>00935         <span class="keywordflow">if</span> (a == <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>) <span class="keywordflow">break</span>;
<a name="l00936"></a>00936         a -&gt; sister -&gt; r_cap += bottleneck;
<a name="l00937"></a>00937         a -&gt; r_cap -= bottleneck;
<a name="l00938"></a>00938         <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>)
<a name="l00939"></a>00939         {
<a name="l00940"></a>00940             set_orphan_front(i); <span class="comment">// add i to the beginning of the adoption list</span>
<a name="l00941"></a>00941         }
<a name="l00942"></a>00942     }
<a name="l00943"></a>00943     i -&gt; tr_cap += bottleneck;
<a name="l00944"></a>00944     <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a>)
<a name="l00945"></a>00945     {
<a name="l00946"></a>00946         set_orphan_front(i); <span class="comment">// add i to the beginning of the adoption list</span>
<a name="l00947"></a>00947     }
<a name="l00948"></a>00948 
<a name="l00949"></a>00949 
<a name="l00950"></a>00950     flow += bottleneck;
<a name="l00951"></a>00951 }
<a name="l00952"></a>00952 
<a name="l00953"></a>00953 <span class="comment">/***********************************************************************/</span>
<a name="l00954"></a>00954 
<a name="l00955"></a>00955 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l00956"></a><a class="code" href="classanima_1_1Graph.html#aac9d70b6ee9606f93abf821120ab4c6d">00956</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#aac9d70b6ee9606f93abf821120ab4c6d">Graph&lt;captype,tcaptype,flowtype&gt;::process_source_orphan</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i)
<a name="l00957"></a>00957 {
<a name="l00958"></a>00958     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *j;
<a name="l00959"></a>00959     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *a0, *a0_min = NULL, *a;
<a name="l00960"></a>00960     <span class="keywordtype">int</span> d, d_min = <a class="code" href="animaGraph_8h.html#aa9bc927cb28ad2010a73a6506fb39519">INFINITE_D</a>;
<a name="l00961"></a>00961 
<a name="l00962"></a>00962     <span class="comment">/* trying to find a new parent */</span>
<a name="l00963"></a>00963     <span class="keywordflow">for</span> (a0=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a0; a0=a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l00964"></a>00964         <span class="keywordflow">if</span> (a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>)
<a name="l00965"></a>00965         {
<a name="l00966"></a>00966         j = a0 -&gt; head;
<a name="l00967"></a>00967         <span class="keywordflow">if</span> (!j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> &amp;&amp; (a=j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>))
<a name="l00968"></a>00968         {
<a name="l00969"></a>00969             <span class="comment">/* checking the origin of j */</span>
<a name="l00970"></a>00970             d = 0;
<a name="l00971"></a>00971             <span class="keywordflow">while</span> ( 1 )
<a name="l00972"></a>00972             {
<a name="l00973"></a>00973                 <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> == TIME)
<a name="l00974"></a>00974                 {
<a name="l00975"></a>00975                     d += j -&gt; DIST;
<a name="l00976"></a>00976                     <span class="keywordflow">break</span>;
<a name="l00977"></a>00977                 }
<a name="l00978"></a>00978                 a = j -&gt; parent;
<a name="l00979"></a>00979                 d ++;
<a name="l00980"></a>00980                 <span class="keywordflow">if</span> (a==<a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>)
<a name="l00981"></a>00981                 {
<a name="l00982"></a>00982                     j -&gt; TS = TIME;
<a name="l00983"></a>00983                     j -&gt; DIST = 1;
<a name="l00984"></a>00984                     <span class="keywordflow">break</span>;
<a name="l00985"></a>00985                 }
<a name="l00986"></a>00986                 <span class="keywordflow">if</span> (a==<a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a>) { d = <a class="code" href="animaGraph_8h.html#aa9bc927cb28ad2010a73a6506fb39519">INFINITE_D</a>; <span class="keywordflow">break</span>; }
<a name="l00987"></a>00987                 j = a -&gt; head;
<a name="l00988"></a>00988             }
<a name="l00989"></a>00989             <span class="keywordflow">if</span> (d&lt;<a class="code" href="animaGraph_8h.html#aa9bc927cb28ad2010a73a6506fb39519">INFINITE_D</a>) <span class="comment">/* j originates from the source - done */</span>
<a name="l00990"></a>00990             {
<a name="l00991"></a>00991                 <span class="keywordflow">if</span> (d&lt;d_min)
<a name="l00992"></a>00992                 {
<a name="l00993"></a>00993                     a0_min = a0;
<a name="l00994"></a>00994                     d_min = d;
<a name="l00995"></a>00995                 }
<a name="l00996"></a>00996                 <span class="comment">/* set marks along the path */</span>
<a name="l00997"></a>00997                 <span class="keywordflow">for</span> (j=a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>; j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a>!=TIME; j=j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>)
<a name="l00998"></a>00998                 {
<a name="l00999"></a>00999                     j -&gt; TS = TIME;
<a name="l01000"></a>01000                     j -&gt; DIST = d --;
<a name="l01001"></a>01001                 }
<a name="l01002"></a>01002             }
<a name="l01003"></a>01003         }
<a name="l01004"></a>01004     }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006     <span class="keywordflow">if</span> ((i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> = a0_min))
<a name="l01007"></a>01007     {
<a name="l01008"></a>01008         i -&gt; TS = TIME;
<a name="l01009"></a>01009         i -&gt; DIST = d_min + 1;
<a name="l01010"></a>01010     }
<a name="l01011"></a>01011     <span class="keywordflow">else</span>
<a name="l01012"></a>01012     {
<a name="l01013"></a>01013         <span class="comment">/* no parent is found */</span>
<a name="l01014"></a>01014         add_to_changed_list(i);
<a name="l01015"></a>01015 
<a name="l01016"></a>01016         <span class="comment">/* process neighbors */</span>
<a name="l01017"></a>01017         <span class="keywordflow">for</span> (a0=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a0; a0=a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l01018"></a>01018         {
<a name="l01019"></a>01019             j = a0 -&gt; head;
<a name="l01020"></a>01020             <span class="keywordflow">if</span> (!j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> &amp;&amp; (a=j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>))
<a name="l01021"></a>01021             {
<a name="l01022"></a>01022                 <span class="keywordflow">if</span> (a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>) set_active(j);
<a name="l01023"></a>01023                 <span class="keywordflow">if</span> (a!=<a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a> &amp;&amp; a!=<a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a> &amp;&amp; a-&gt;head==i)
<a name="l01024"></a>01024                 {
<a name="l01025"></a>01025                     set_orphan_rear(j); <span class="comment">// add j to the end of the adoption list</span>
<a name="l01026"></a>01026                 }
<a name="l01027"></a>01027             }
<a name="l01028"></a>01028         }
<a name="l01029"></a>01029     }
<a name="l01030"></a>01030 }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l01033"></a><a class="code" href="classanima_1_1Graph.html#aab21e9899a5e2984067cf9f4cce57d2a">01033</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#aab21e9899a5e2984067cf9f4cce57d2a">Graph&lt;captype,tcaptype,flowtype&gt;::process_sink_orphan</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i)
<a name="l01034"></a>01034 {
<a name="l01035"></a>01035     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *j;
<a name="l01036"></a>01036     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *a0, *a0_min = NULL, *a;
<a name="l01037"></a>01037     <span class="keywordtype">int</span> d, d_min = <a class="code" href="animaGraph_8h.html#aa9bc927cb28ad2010a73a6506fb39519">INFINITE_D</a>;
<a name="l01038"></a>01038 
<a name="l01039"></a>01039     <span class="comment">/* trying to find a new parent */</span>
<a name="l01040"></a>01040     <span class="keywordflow">for</span> (a0=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a0; a0=a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l01041"></a>01041         <span class="keywordflow">if</span> (a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>)
<a name="l01042"></a>01042         {
<a name="l01043"></a>01043         j = a0 -&gt; head;
<a name="l01044"></a>01044         <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> &amp;&amp; (a=j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>))
<a name="l01045"></a>01045         {
<a name="l01046"></a>01046             <span class="comment">/* checking the origin of j */</span>
<a name="l01047"></a>01047             d = 0;
<a name="l01048"></a>01048             <span class="keywordflow">while</span> ( 1 )
<a name="l01049"></a>01049             {
<a name="l01050"></a>01050                 <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> == TIME)
<a name="l01051"></a>01051                 {
<a name="l01052"></a>01052                     d += j -&gt; DIST;
<a name="l01053"></a>01053                     <span class="keywordflow">break</span>;
<a name="l01054"></a>01054                 }
<a name="l01055"></a>01055                 a = j -&gt; parent;
<a name="l01056"></a>01056                 d ++;
<a name="l01057"></a>01057                 <span class="keywordflow">if</span> (a==<a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>)
<a name="l01058"></a>01058                 {
<a name="l01059"></a>01059                     j -&gt; TS = TIME;
<a name="l01060"></a>01060                     j -&gt; DIST = 1;
<a name="l01061"></a>01061                     <span class="keywordflow">break</span>;
<a name="l01062"></a>01062                 }
<a name="l01063"></a>01063                 <span class="keywordflow">if</span> (a==<a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a>) { d = <a class="code" href="animaGraph_8h.html#aa9bc927cb28ad2010a73a6506fb39519">INFINITE_D</a>; <span class="keywordflow">break</span>; }
<a name="l01064"></a>01064                 j = a -&gt; head;
<a name="l01065"></a>01065             }
<a name="l01066"></a>01066             <span class="keywordflow">if</span> (d&lt;<a class="code" href="animaGraph_8h.html#aa9bc927cb28ad2010a73a6506fb39519">INFINITE_D</a>) <span class="comment">/* j originates from the sink - done */</span>
<a name="l01067"></a>01067             {
<a name="l01068"></a>01068                 <span class="keywordflow">if</span> (d&lt;d_min)
<a name="l01069"></a>01069                 {
<a name="l01070"></a>01070                     a0_min = a0;
<a name="l01071"></a>01071                     d_min = d;
<a name="l01072"></a>01072                 }
<a name="l01073"></a>01073                 <span class="comment">/* set marks along the path */</span>
<a name="l01074"></a>01074                 <span class="keywordflow">for</span> (j=a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>; j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a>!=TIME; j=j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>)
<a name="l01075"></a>01075                 {
<a name="l01076"></a>01076                     j -&gt; TS = TIME;
<a name="l01077"></a>01077                     j -&gt; DIST = d --;
<a name="l01078"></a>01078                 }
<a name="l01079"></a>01079             }
<a name="l01080"></a>01080         }
<a name="l01081"></a>01081     }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083     <span class="keywordflow">if</span> ((i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> = a0_min))
<a name="l01084"></a>01084     {
<a name="l01085"></a>01085         i -&gt; TS = TIME;
<a name="l01086"></a>01086         i -&gt; DIST = d_min + 1;
<a name="l01087"></a>01087     }
<a name="l01088"></a>01088     <span class="keywordflow">else</span>
<a name="l01089"></a>01089     {
<a name="l01090"></a>01090         <span class="comment">/* no parent is found */</span>
<a name="l01091"></a>01091         add_to_changed_list(i);
<a name="l01092"></a>01092 
<a name="l01093"></a>01093         <span class="comment">/* process neighbors */</span>
<a name="l01094"></a>01094         <span class="keywordflow">for</span> (a0=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a0; a0=a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l01095"></a>01095         {
<a name="l01096"></a>01096             j = a0 -&gt; head;
<a name="l01097"></a>01097             <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a> &amp;&amp; (a=j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>))
<a name="l01098"></a>01098             {
<a name="l01099"></a>01099                 <span class="keywordflow">if</span> (a0-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>) set_active(j);
<a name="l01100"></a>01100                 <span class="keywordflow">if</span> (a!=<a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a> &amp;&amp; a!=<a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a> &amp;&amp; a-&gt;head==i)
<a name="l01101"></a>01101                 {
<a name="l01102"></a>01102                     set_orphan_rear(j); <span class="comment">// add j to the end of the adoption list</span>
<a name="l01103"></a>01103                 }
<a name="l01104"></a>01104             }
<a name="l01105"></a>01105         }
<a name="l01106"></a>01106     }
<a name="l01107"></a>01107 }
<a name="l01108"></a>01108 
<a name="l01109"></a>01109 <span class="comment">/***********************************************************************/</span>
<a name="l01110"></a>01110 
<a name="l01111"></a>01111 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l01112"></a><a class="code" href="classanima_1_1Graph.html#a9da5daefeba42c4d9c1d3ae401c7cef9">01112</a>         <span class="keyword">inline</span> flowtype <a class="code" href="classanima_1_1Graph.html#a9da5daefeba42c4d9c1d3ae401c7cef9">Graph&lt;captype,tcaptype,flowtype&gt;::maxflow</a>(<span class="keywordtype">bool</span> reuse_trees, <a class="code" href="classanima_1_1Block.html">Block&lt;node_id&gt;</a>* _changed_list)
<a name="l01113"></a>01113 {
<a name="l01114"></a>01114     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i, *j, *current_node = NULL;
<a name="l01115"></a>01115     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *a;
<a name="l01116"></a>01116     <a class="code" href="structanima_1_1Graph_1_1nodeptr.html">nodeptr</a> *np, *np_next;
<a name="l01117"></a>01117 
<a name="l01118"></a>01118     <span class="keywordflow">if</span> (!nodeptr_block)
<a name="l01119"></a>01119     {
<a name="l01120"></a>01120         nodeptr_block = <span class="keyword">new</span> <a class="code" href="classanima_1_1DBlock.html">DBlock&lt;nodeptr&gt;</a>(NODEPTR_BLOCK_SIZE, error_function);
<a name="l01121"></a>01121     }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123     changed_list = _changed_list;
<a name="l01124"></a>01124     <span class="keywordflow">if</span> (maxflow_iteration == 0 &amp;&amp; reuse_trees) { <span class="comment">/*if (error_function) (*error_function)(&quot;reuse_trees cannot be used in the first call to maxflow()!&quot;);*/</span> exit(1); }
<a name="l01125"></a>01125     <span class="keywordflow">if</span> (changed_list &amp;&amp; !reuse_trees) { <span class="comment">/*if (error_function) (*error_function)(&quot;changed_list cannot be used without reuse_trees!&quot;);*/</span> exit(1); }
<a name="l01126"></a>01126 
<a name="l01127"></a>01127     <span class="keywordflow">if</span> (reuse_trees) maxflow_reuse_trees_init();
<a name="l01128"></a>01128     <span class="keywordflow">else</span>             maxflow_init();
<a name="l01129"></a>01129 
<a name="l01130"></a>01130     <span class="comment">// main loop</span>
<a name="l01131"></a>01131     <span class="keywordflow">while</span> ( 1 )
<a name="l01132"></a>01132     {
<a name="l01133"></a>01133         <span class="comment">// test_consistency(current_node);</span>
<a name="l01134"></a>01134 
<a name="l01135"></a>01135         <span class="keywordflow">if</span> ((i=current_node))
<a name="l01136"></a>01136         {
<a name="l01137"></a>01137             i -&gt; next = NULL; <span class="comment">/* remove active flag */</span>
<a name="l01138"></a>01138             <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>) i = NULL;
<a name="l01139"></a>01139         }
<a name="l01140"></a>01140         <span class="keywordflow">if</span> (!i)
<a name="l01141"></a>01141         {
<a name="l01142"></a>01142             <span class="keywordflow">if</span> (!(i = next_active())) <span class="keywordflow">break</span>;
<a name="l01143"></a>01143         }
<a name="l01144"></a>01144 
<a name="l01145"></a>01145         <span class="comment">/* growth */</span>
<a name="l01146"></a>01146         <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>)
<a name="l01147"></a>01147         {
<a name="l01148"></a>01148             <span class="comment">/* grow source tree */</span>
<a name="l01149"></a>01149             <span class="keywordflow">for</span> (a=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a; a=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l01150"></a>01150                 <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>)
<a name="l01151"></a>01151                 {
<a name="l01152"></a>01152                 j = a -&gt; head;
<a name="l01153"></a>01153                 <span class="keywordflow">if</span> (!j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>)
<a name="l01154"></a>01154                 {
<a name="l01155"></a>01155                     j -&gt; is_sink = 0;
<a name="l01156"></a>01156                     j -&gt; parent = a -&gt; sister;
<a name="l01157"></a>01157                     j -&gt; TS = i -&gt; TS;
<a name="l01158"></a>01158                     j -&gt; DIST = i -&gt; DIST + 1;
<a name="l01159"></a>01159                     set_active(j);
<a name="l01160"></a>01160                     add_to_changed_list(j);
<a name="l01161"></a>01161                 }
<a name="l01162"></a>01162                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>) <span class="keywordflow">break</span>;
<a name="l01163"></a>01163                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> &lt;= i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> &amp;&amp;
<a name="l01164"></a>01164                          j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">DIST</a> &gt; i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">DIST</a>)
<a name="l01165"></a>01165                 {
<a name="l01166"></a>01166                     <span class="comment">/* heuristic - trying to make the distance from j to the source shorter */</span>
<a name="l01167"></a>01167                     j -&gt; parent = a -&gt; sister;
<a name="l01168"></a>01168                     j -&gt; TS = i -&gt; TS;
<a name="l01169"></a>01169                     j -&gt; DIST = i -&gt; DIST + 1;
<a name="l01170"></a>01170                 }
<a name="l01171"></a>01171             }
<a name="l01172"></a>01172         }
<a name="l01173"></a>01173         <span class="keywordflow">else</span>
<a name="l01174"></a>01174         {
<a name="l01175"></a>01175             <span class="comment">/* grow sink tree */</span>
<a name="l01176"></a>01176             <span class="keywordflow">for</span> (a=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a; a=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l01177"></a>01177                 <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a>)
<a name="l01178"></a>01178                 {
<a name="l01179"></a>01179                 j = a -&gt; head;
<a name="l01180"></a>01180                 <span class="keywordflow">if</span> (!j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>)
<a name="l01181"></a>01181                 {
<a name="l01182"></a>01182                     j -&gt; is_sink = 1;
<a name="l01183"></a>01183                     j -&gt; parent = a -&gt; sister;
<a name="l01184"></a>01184                     j -&gt; TS = i -&gt; TS;
<a name="l01185"></a>01185                     j -&gt; DIST = i -&gt; DIST + 1;
<a name="l01186"></a>01186                     set_active(j);
<a name="l01187"></a>01187                     add_to_changed_list(j);
<a name="l01188"></a>01188                 }
<a name="l01189"></a>01189                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>) { a = a -&gt; sister; <span class="keywordflow">break</span>; }
<a name="l01190"></a>01190                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> &lt;= i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> &amp;&amp;
<a name="l01191"></a>01191                          j-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">DIST</a> &gt; i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">DIST</a>)
<a name="l01192"></a>01192                 {
<a name="l01193"></a>01193                     <span class="comment">/* heuristic - trying to make the distance from j to the sink shorter */</span>
<a name="l01194"></a>01194                     j -&gt; parent = a -&gt; sister;
<a name="l01195"></a>01195                     j -&gt; TS = i -&gt; TS;
<a name="l01196"></a>01196                     j -&gt; DIST = i -&gt; DIST + 1;
<a name="l01197"></a>01197                 }
<a name="l01198"></a>01198             }
<a name="l01199"></a>01199         }
<a name="l01200"></a>01200 
<a name="l01201"></a>01201         TIME ++;
<a name="l01202"></a>01202 
<a name="l01203"></a>01203         <span class="keywordflow">if</span> (a)
<a name="l01204"></a>01204         {
<a name="l01205"></a>01205             i -&gt; next = i; <span class="comment">/* set active flag */</span>
<a name="l01206"></a>01206             current_node = i;
<a name="l01207"></a>01207 
<a name="l01208"></a>01208             <span class="comment">/* augmentation */</span>
<a name="l01209"></a>01209             augment(a);
<a name="l01210"></a>01210             <span class="comment">/* augmentation end */</span>
<a name="l01211"></a>01211 
<a name="l01212"></a>01212             <span class="comment">/* adoption */</span>
<a name="l01213"></a>01213             <span class="keywordflow">while</span> ((np=orphan_first))
<a name="l01214"></a>01214             {
<a name="l01215"></a>01215                 np_next = np -&gt; next;
<a name="l01216"></a>01216                 np -&gt; next = NULL;
<a name="l01217"></a>01217 
<a name="l01218"></a>01218                 <span class="keywordflow">while</span> ((np=orphan_first))
<a name="l01219"></a>01219                 {
<a name="l01220"></a>01220                     orphan_first = np -&gt; next;
<a name="l01221"></a>01221                     i = np -&gt; ptr;
<a name="l01222"></a>01222                     nodeptr_block -&gt; Delete(np);
<a name="l01223"></a>01223                     <span class="keywordflow">if</span> (!orphan_first) orphan_last = NULL;
<a name="l01224"></a>01224                     <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>) process_sink_orphan(i);
<a name="l01225"></a>01225                     <span class="keywordflow">else</span>            process_source_orphan(i);
<a name="l01226"></a>01226                 }
<a name="l01227"></a>01227 
<a name="l01228"></a>01228                 orphan_first = np_next;
<a name="l01229"></a>01229             }
<a name="l01230"></a>01230             <span class="comment">/* adoption end */</span>
<a name="l01231"></a>01231         }
<a name="l01232"></a>01232         <span class="keywordflow">else</span> current_node = NULL;
<a name="l01233"></a>01233     }
<a name="l01234"></a>01234     <span class="comment">// test_consistency();</span>
<a name="l01235"></a>01235 
<a name="l01236"></a>01236     <span class="keywordflow">if</span> (!reuse_trees || (maxflow_iteration % 64) == 0)
<a name="l01237"></a>01237     {
<a name="l01238"></a>01238         <span class="keyword">delete</span> nodeptr_block;
<a name="l01239"></a>01239         nodeptr_block = NULL;
<a name="l01240"></a>01240     }
<a name="l01241"></a>01241 
<a name="l01242"></a>01242     maxflow_iteration ++;
<a name="l01243"></a>01243     <span class="keywordflow">return</span> flow;
<a name="l01244"></a>01244 }
<a name="l01245"></a>01245 
<a name="l01246"></a>01246 <span class="comment">/***********************************************************************/</span>
<a name="l01247"></a>01247 
<a name="l01248"></a>01248 
<a name="l01249"></a>01249 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> captype, <span class="keyword">typename</span> tcaptype, <span class="keyword">typename</span> flowtype&gt;
<a name="l01250"></a><a class="code" href="classanima_1_1Graph.html#a16d4d26f6655e2095c9b6ce22cc1c04f">01250</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classanima_1_1Graph.html#a16d4d26f6655e2095c9b6ce22cc1c04f">Graph&lt;captype,tcaptype,flowtype&gt;::test_consistency</a>(<a class="code" href="structanima_1_1Graph_1_1node.html">node</a>* current_node)
<a name="l01251"></a>01251 {
<a name="l01252"></a>01252     <a class="code" href="structanima_1_1Graph_1_1node.html">node</a> *i;
<a name="l01253"></a>01253     <a class="code" href="structanima_1_1Graph_1_1arc.html">arc</a> *a;
<a name="l01254"></a>01254     <span class="keywordtype">int</span> r;
<a name="l01255"></a>01255     <span class="keywordtype">int</span> num1 = 0, num2 = 0;
<a name="l01256"></a>01256 
<a name="l01257"></a>01257     <span class="comment">// test whether all nodes i with i-&gt;next!=NULL are indeed in the queue</span>
<a name="l01258"></a>01258     <span class="keywordflow">for</span> (i=nodes; i&lt;node_last; i++)
<a name="l01259"></a>01259     {
<a name="l01260"></a>01260         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a> || i==current_node) num1 ++;
<a name="l01261"></a>01261     }
<a name="l01262"></a>01262     <span class="keywordflow">for</span> (r=0; r&lt;3; r++)
<a name="l01263"></a>01263     {
<a name="l01264"></a>01264         i = (r == 2) ? current_node : queue_first[r];
<a name="l01265"></a>01265         <span class="keywordflow">if</span> (i)
<a name="l01266"></a>01266             <span class="keywordflow">for</span> ( ; ; i=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a>)
<a name="l01267"></a>01267             {
<a name="l01268"></a>01268             num2 ++;
<a name="l01269"></a>01269             <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a> == i)
<a name="l01270"></a>01270             {
<a name="l01271"></a>01271                 <span class="keywordflow">if</span> (r&lt;2) assert(i == queue_last[r]);
<a name="l01272"></a>01272                 <span class="keywordflow">else</span>     assert(i == current_node);
<a name="l01273"></a>01273                 <span class="keywordflow">break</span>;
<a name="l01274"></a>01274             }
<a name="l01275"></a>01275         }
<a name="l01276"></a>01276     }
<a name="l01277"></a>01277     assert(num1 == num2);
<a name="l01278"></a>01278 
<a name="l01279"></a>01279     <span class="keywordflow">for</span> (i=nodes; i&lt;node_last; i++)
<a name="l01280"></a>01280     {
<a name="l01281"></a>01281         <span class="comment">// test whether all edges in seach trees are non-saturated</span>
<a name="l01282"></a>01282         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> == NULL) {}
<a name="l01283"></a>01283         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> == <a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a>) {}
<a name="l01284"></a>01284         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> == <a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>)
<a name="l01285"></a>01285         {
<a name="l01286"></a>01286             <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>) assert(i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> &gt; 0);
<a name="l01287"></a>01287             <span class="keywordflow">else</span>             assert(i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> &lt; 0);
<a name="l01288"></a>01288         }
<a name="l01289"></a>01289         <span class="keywordflow">else</span>
<a name="l01290"></a>01290         {
<a name="l01291"></a>01291             <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>) assert (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a> &gt; 0);
<a name="l01292"></a>01292             <span class="keywordflow">else</span>             assert (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a> &gt; 0);
<a name="l01293"></a>01293         }
<a name="l01294"></a>01294         <span class="comment">// test whether passive nodes in search trees have neighbors in</span>
<a name="l01295"></a>01295         <span class="comment">// a different tree through non-saturated edges</span>
<a name="l01296"></a>01296         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> &amp;&amp; !i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab5d04a576b8324e7144655c1c8c3112c">next</a>)
<a name="l01297"></a>01297         {
<a name="l01298"></a>01298             <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>)
<a name="l01299"></a>01299             {
<a name="l01300"></a>01300                 assert(i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> &gt;= 0);
<a name="l01301"></a>01301                 <span class="keywordflow">for</span> (a=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a; a=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l01302"></a>01302                 {
<a name="l01303"></a>01303                     <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a> &gt; 0) assert(a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> &amp;&amp; !a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>);
<a name="l01304"></a>01304                 }
<a name="l01305"></a>01305             }
<a name="l01306"></a>01306             <span class="keywordflow">else</span>
<a name="l01307"></a>01307             {
<a name="l01308"></a>01308                 assert(i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a42db6eb1e89a8d30f049a773b6e3b8c2">tr_cap</a> &lt;= 0);
<a name="l01309"></a>01309                 <span class="keywordflow">for</span> (a=i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8bf5065dcb3c95044b9ffb29c97c4443">first</a>; a; a=a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#ab6ab82e883672645c2ed19239a199255">next</a>)
<a name="l01310"></a>01310                 {
<a name="l01311"></a>01311                     <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#abef0cab3661b8b592757e9158882e625">sister</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a5077c0c75411acd7f50b4dce60d67f25">r_cap</a> &gt; 0) assert(a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> &amp;&amp; a-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a8974334dd94393851278a1f57a31cea4">is_sink</a>);
<a name="l01312"></a>01312                 }
<a name="l01313"></a>01313             }
<a name="l01314"></a>01314         }
<a name="l01315"></a>01315         <span class="comment">// test marking invariants</span>
<a name="l01316"></a>01316         <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a> &amp;&amp; i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>!=<a class="code" href="animaGraph_8h.html#ad4caaed3ae8075a052077724e8a1d41f">ORPHAN</a> &amp;&amp; i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>!=<a class="code" href="animaGraph_8h.html#a5250b667cb28dd60b71e6e04e23eac37">TERMINAL</a>)
<a name="l01317"></a>01317         {
<a name="l01318"></a>01318             assert(i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> &lt;= i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a>);
<a name="l01319"></a>01319             <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a> == i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#a3d290ba83698649e56568d522a8453f1">TS</a>) assert(i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">DIST</a> &gt; i-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#adbcc0fd85e8d69d114e6f84185a9efa2">parent</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1arc.html#a2caaea2f14f0f8e154f92375c582b555">head</a>-&gt;<a class="code" href="structanima_1_1Graph_1_1node.html#ab8c732c84a25395f739ec9eff7cb1094">DIST</a>);
<a name="l01320"></a>01320         }
<a name="l01321"></a>01321     }
<a name="l01322"></a>01322 }
<a name="l01323"></a>01323 
<a name="l01324"></a>01324 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<!-- start footer part -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 7 2017 14:33:05 for ANIMA by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36582801-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
